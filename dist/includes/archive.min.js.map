{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/js/archive.js","webpack:///./node_modules/ia-design-system/public/scripts/index.js","webpack:///./src/js/setUpCopyableTexts.js","webpack:///./node_modules/clipboard/dist/clipboard.js","webpack:///./src/less/archive.less"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","$","window","jQuery","log","location","host","substr","console","AJS","elm","in_show","parents","id","chan","show","length","opened","parent","find","toggle","attr","text","concat","div","url","href","encodeURIComponent","htm","append","isTouchDevice","addClass","logoText","on","removeClass","evt","xs","hat_open","hasClass","navlink","this","mt","target","currentTarget","isnow","hide","collapse","tophat_dont_count_first_open","archive_analytics","send_ping","kind","ec","ea","el","pathname","cache_bust","Math","random","one","setTimeout","click","has","document","event","$e","is","DocumentTouch","fn","tooltip","$sharedown","$wrapdark","wrapdark_watcher_ptr","setInterval","wrapdark_watcher","wrapdarkHT","offset","top","innerHeight","parseInt","css","height","clearInterval","mutedNOW","cookie","emulator","setMute","player","jwplayer","volnow","getVolume","mute_click_prior_volume","setVolume","path","expires","game","toString","identifier","IALoader","scale","parseFloat","indexOf","unmute","mute","theatre_controls_position","clearTimeout","theatre_controls_position_throttler","prepend","appendTo","fadeOut","start","hasCustomCSS","EM","JSMESS","DOSBOX","canvas","webkitRequestFullScreen","mozRequestFullScreen","requestFullScreen","Module","addEventListener","fullScreenChangeHandler","$selectorIn","pegTop","widthIn","heightIn","$selector","video","width","right_gutter_width","round","visibility","right","max","theatresize","$textyiframe","changeBgColor","$contentDom","contentDocument","bgColorInterval","data","booksize_controls_hidden","booksize_controls","bookSizeInterval","$iframe","$iframeDOM","$book","$navbar","overflow","resizer","maxH","maxW","outerWidth","WH","min","popcorn_throttler","onChange","theatresize_maxheight","minHeight","targetHeight","theatresize_throttler","selector","enableThreatreChange","$carousel","imagePromises","map","img","promise","Deferred","result","complete","resolve","naturalHeight","when","then","currHeight","maxImageHeight","trigger","jw","getState","toLowerCase","pause","lnk","switchToA2Z","props","selectorID","contents","className","type","data-dismiss","aria-hidden","ReactDOM","render","modal","MORFreact","modal_go","title","headerClass","ignore_lnk","auto_remove","body","val","alert","cleaned","replace","opts","options","container","content","html","placement","popover","first","C3","C234","availWidth","C2","C4","cookie_range","prefer","showdetails","checked","defaults","btn","$body","to","domain","toggleClass","tiler","inTab","trim","tmp","ikind","each","k","row","mouseover","e","mouseout","selectorIn","noRecall","prop","$parentRow","tilerPREV","winW","pad","nPerRow","gutter","tileWidth","TILE_WIDTH","unsourced","firstLeft","parent_hover","$facets","facetsWidth","TILE_WIDTH_SMALL","floor","extra","nImgZeroHeight","nImgZeroHeightAry","maxtop","tops","0","lefts","v","src","onError","removeAttr","colPREV","not","idx","$val","$valHT","col","colTEST","cmpTEST","left","push","join","tiler_throttler","idsel","$sel","$new","$now","ikind_mobile_change_ignore_next","$selopt","$ikinds","filter","pageType","pushState","history","tabPick","hash2arg","tab","arg","tabby_no_pushState_next_click","locNOW","locNEW","protocol","grafs","alsoFoundElement","$window","throttledListener","threshhold","context","undefined","last","deferTimeout","args","now","Date","callFn","apply","throttle","alsoFound","topOffset","windowHeight","lazyLoadStart","scrollTop","LoadingMessage","message","doWhenScrolledToRelatedSection","off","scroll","getRelatedItems","response","RelatedItemSection","dataHash","tilebars","catch","error","ErrorMessage","errorMsg","size","Promise","reject","apiUrl","param","hashData","apiError","items","hits","Error","forEach","item","itemSource","_source","singleHash","_id","numReviews","lendingEnabled","lendingAvailable","loginRequired","lendClass","favorite","creator","downloads","mediatype","txt","charAt","toUpperCase","match","xer","$item","idX","listkind","remove","next","ids","toArray","reduce","a","b","$form","submit","head_img_dragdrop_setup_done","head_img_replaceable","file_picked","stopPropagation","preventDefault","over","x","pageX","originalEvent","y","pageY","outerHeight","cancelFile","files","file2post","previewFile","dataTransfer","fail","XMLHttpRequest","badFile","xhr","upload","open","setRequestHeader","send","reply","responseText","mat","task_id","stalker_ptr","ajax","dataType","success","xml","green","blue","red","nWait","uploadFile","w1","h1","w2","h2","ios","FileReader","reader","onload","im","Image","readAsDataURL","pageinfo","urlstart","multi_year","last_year","year","str","lastyearmonth","pages","split","month","day","yearmonth","skip_day","monthName","page","pnum","j","$grafs1","$grafs2","setUpTopRegionsTable","slideDown","slideUp","format","$formatGroup","theArgName","try_full","sArgs","search","slice","unescape","mousetimer","fadeIn","mouseleave","newtop","check","more_searching","urlIn","page_now","$more_search","pageKey","page_map","urlreplace","replaceState","addNotes","addingNotesKind","more_search_throttler","send_scroll_fetch_event","embid","$embid","embtxt","class","position","padding","bestHT","conf","confIn","feedback_only","_modal_add","exiting","submitted","postdata","serialize","post","exitFN","bookmarkRes","center","auto_close","login","shown","follow_link_on_dismiss","htmIn","keyvals","res","isFavoriteSuccessful","$favModal","failMessage","obj","nStr","x1","x2","rgx","test","axis","toFixed","suffixFmt","offsetHeight","scrollHeight","callback","plotters","cfgIn","fmt_fn","pts","many","cfg","xaxis","color","dark","yaxis","barWidth","dayBarsNoPoints","series","bars","fill","points","grid","borderColor","hoverable","backgroundColor","tip","GraphPriorIndex","ary","noLabel","label","selid","plot","pos","dataIndex","datapoint","$graf","pegTo","pegToVal","ColorThief","welcome_recolored","palette","getPalette","dominantColorRGB","avgVal","element","code","keyCode","which","multiValSplitChar","autocomplete","minLength","source","request","ui","term","pop","focus","select","terms","addNoteHTM","$htm","prev","$note","action","$parent","$origNote","TV","TV2","unplay","thumbzillas","startend","TV3","CLIP_SEC_MAX2","winH","w","h","WAYBACK","REDIRECT_URL","REDIRECT_SEARCH","search_or_calendar","query","$input","fireAnalyticsTrackingEvent","typeahead","cache","done","process","hosts","isUrl","excluded","display_name","data2","matcher","displayText","autoSelect","delay","fitToElement","minLenght","change","current","params","scrollbars","resizable","toolbar","directories","menubar","status","keys","paramPairs","children","handleClick","openPopup","onClick","root","querySelector","CreativeCommonsLicenseLink","dataset","licenseName","licenseSelected","setUpSearchForm","formNode","form","searchBar","searchOptions","keepOpenWhenChanged","formChanged","handleFocusChange","targetElement","contains","waybackMachineSearchUrl","elements","checkedInput","searchInput","sinValue","searchValue","relatedTarget","index","node","iframe","hasAttribute","fragment","pathString","newFragment","fragmentRegex","hash","updateUrl","Array","from","querySelectorAll","accordion","handleToggle","detailsEls","selectedDetails","details","animate","setAttribute","link","is_advanced_TV_search","adv","mapping","ymd","toISOString","ajaxSetup","getScript","TVSearch","getJSON","proPick","hostname","category","actionHandler","attributeName","categoryAction","categoryActionParts","aria-label","data-id","data-mediatype","data-year","tabIndex","data-event-click-tracking","alt","caption","captionClass","counts","scope","count","state","country","formattedName","formattedCount","originalMessageText","apiOptions","uaKinds","days","limit","StatsApiClient","getGeoCounts","RegionsTable","navigator","userAgent","cgi_args","Timegraf","leftTS","riteTS","minDate","maxDate","realGraphWidth","GRAPH_WIDTH","GRAPH_PADDING","maxSlide","getTime","csMinTS","rite","$sliderdiv","GRAPH_HEIGHT","zIndex","slider","range","values","slide","ts","d1","d2","setDate","getDate","datepicker","formatDate","hideL","hideR","foff","toff","pinkme","stop","adjust","timechanged","become","q","pinkL","rect","onedayspan","from2","to2","StatsRegion","GeoCount","addCommas","createGeoCountFromApiData","sum_count_value","geo_country","geo_state","createCombinedGeoCountsFromApiData","counts_geo","RangeError","uaKind","countsMap","countData","ua_kind","mapKey","apiBaseUrl","sort","count1","count2","React","createClass","DEFAULT_LINK_TEXT","defaultProps","getInitialState","linkText","oldLicenseName","componentWillReceiveProps","newProps","setState","removeLicense","removeRetainLicenseInput","formItem","getElementById","parentNode","removeChild","wasLicensedChanged","getLicenseChangeMessage","PopupLink","FACETS_PER_PAGE","mounted","hdr","getFacets","self","ret","refs","componentDidMount","pageClick","submitClick","morf","loading","option","ref","paging","npages","ceil","loadnote","style","margin","date","toUTCString","setTime","secure","cookieValue","cookies","substring","decodeURIComponent","myheight","scrollLeft","vpW","innerWidth","vpH","display","makeMouseElementAccessible","setUpActionTracking","nav_tophat_setup","nav_tophat_wb_setup","setupPopupLink","setUpCreativeCommonsLicenseLink","setUpSearchForms","setUpBookReaderIframe","setUpAccordions","setUpRelatedItems","archive_setup","footer","default","showStatusMessage","copyableText","output","createElement","appendChild","textContent","setUpCopyableText","button","createButton","clipboard","copyableTexts","ClipboardJS","isSupported","parentElement","getAttribute","factory","_typeof","iterator","constructor","_createClass","defineProperties","descriptor","configurable","writable","Constructor","protoProps","staticProps","_clipboardAction2","_interopRequireDefault","_tinyEmitter2","_goodListener2","Clipboard","_Emitter","instance","TypeError","_classCallCheck","_this","ReferenceError","_possibleConstructorReturn","__proto__","getPrototypeOf","resolveOptions","listenClick","subClass","superClass","setPrototypeOf","_inherits","arguments","defaultAction","defaultTarget","defaultText","_this2","listener","delegateTarget","clipboardAction","emitter","getAttributeValue","destroy","actions","support","queryCommandSupported","suffix","attribute","_select","_select2","ClipboardAction","initSelection","selectedText","selectFake","selectTarget","isRTL","documentElement","removeFake","fakeHandlerCallback","fakeHandler","fakeElem","fontSize","border","yPosition","pageYOffset","copyText","removeEventListener","succeeded","execCommand","err","handleResult","emit","clearSelection","getSelection","removeAllRanges","set","_action","nodeType","_target","nodeName","isReadOnly","setSelectionRange","removeAttribute","selection","createRange","selectNodeContents","addRange","E","ctx","once","_","evtArr","len","evts","liveEvents","delegate","string","listenNode","nodeList","listenNodeList","listenSelector","HTMLElement","String","closest","_delegate","useCapture","listenerFn","DOCUMENT_NODE_TYPE","Element","matches","proto","matchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector"],"mappings":"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","file":"archive.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","// Not using anything from the design system right now, imported as a proof of concept.\n// eslint-disable-next-line no-unused-vars\nimport IaDesignSystem from 'ia-design-system'\n\nimport setUpCopyableTexts from './setUpCopyableTexts'\n\n// Local binding in case of conflicts in global scope\nconst $ = window.jQuery\n\n// convenient, no?  Stateless function, global to all Play objects\n//   eslint-disable-next-line  no-console\nconst log = (location.host.substr(0, 4) !== 'www-' ? () => {} : console.log.bind(console))\n\n/**\n * Executes a function no more than once within the specified time threshhold\n *\n * Pass its return value into high-frequency event listeners\n * like scroll/resize to improve performance.\n *\n * @param {Function} fn\n * @param {Number}   threshhold - in milliseconds\n * @param {*}        context    - will be bound to fn as its \"this\" value\n * @return {Function} the throttled version of the original function\n */\nfunction throttle(fn, threshhold = 250, context = undefined) {\n  let last\n  let deferTimeout\n\n  return (...args) => {\n    // Convert to a Number\n    const now = +new Date()\n\n    /**\n     * Calls the fn function and updates the last time\n     */\n    function callFn() {\n      last = now\n      fn.apply(context, args)\n    }\n\n    if (last && now < last + threshhold) {\n      clearTimeout(deferTimeout)\n      deferTimeout = setTimeout(callFn, threshhold)\n    } else {\n      callFn()\n    }\n  }\n}\n\n/**\n * Replaces a BookReader fragment string in a URL path with a new fragment,\n * or adds the path string to the end of the URL if it's not set\n *\n * NOTE: BookReader \"fragments\" are not necessarily URL hash fragments,\n * though they may be stored in the hash.\n *\n * @param {String} pathString\n * @param {String} newFragment\n * @returns {String}\n */\nfunction replaceBookReaderFragment(pathString, newFragment) {\n  // See http://openlibrary.org/dev/docs/bookurls\n  const fragmentRegex = /(\\/((page|mode|search)\\/[^/?$]+))+\\/?(?=\\?|$)/g\n\n  if (pathString.match(fragmentRegex))\n    return pathString.replace(fragmentRegex, `/${newFragment}`)\n\n  return `${pathString}/${newFragment}`.replace(/\\/+/g, '/')\n}\n\n// class memnonic: Archive JS\nclass AJS {\n  /* global  archive_analytics  jwplayer */\n  /* eslint no-underscore-dangle: [\"error\", { \"allow\": [\"_modal_add\"] }] */\n\n\n  static TILE_WIDTH       = 180 // NOTE: needs to stay in sync w/ archive.less\n  static TILE_WIDTH_SMALL = 150 // NOTE: needs to stay in sync w/ archive.less\n\n  static ios = (navigator.userAgent.indexOf('iPhone') > 0  ||\n                navigator.userAgent.indexOf('iPad') > 0  ||\n                navigator.userAgent.indexOf('iPod') > 0)\n  static page_map = {}\n  static cgi_args = {}\n\n  static tvAD(elm) {\n    const in_show = $(elm).parents('.shows')\n    let id\n    let chan\n    let show\n    if (in_show.length) {\n      // see if we've already gotten and displayed the \"Air date\" section...\n      const opened = $(elm).parent().find('.shows')\n      if (opened.length) {\n        // ... yes, simply close/open it\n        opened.toggle()\n        return false\n      }\n      chan = in_show.attr('data-chan')\n      show = $(elm).text()\n    } else {\n      chan = $(elm).text()\n      id = 'menu-chan-'.concat(chan)\n      const div = $(`#${id}`)\n      if (div.length) {\n        div.toggle()\n        return false\n      }\n    }\n\n    let url = `${location.href}?channel=${chan}`\n    if (in_show.length)\n      url += '&program='.concat(encodeURIComponent(show))\n    log(url)\n\n    $.get(url, (htm) => {\n      if (in_show.length) {\n        $(elm).parent()\n          .append(`<div data-chan=\"${chan}\" class=\"shows\"><h5>Air date</h5><div>${htm}</div></div>`)\n      } else {\n        $(elm).parent()\n          .append(`<div id=\"${id}\" data-chan=\"${chan}\" class=\"shows\"><h4>Show</h4><div>${htm}</div></div>`)\n      }\n    })\n\n    return false\n  }\n\n\n  static nav_tophat_setup() {\n    if (!$('#nav-tophat').length)\n      return\n\n    if (AJS.isTouchDevice())\n      $('body').addClass('touch')\n    else\n      AJS.logoText()\n\n\n    $('#nav-tophat')\n      .on('show.bs.collapse', () => $('#navwrap1').addClass('hatted'))\n      .on('hide.bs.collapse', () => $('#navwrap1').removeClass('hatted'))\n\n\n    $('.navbar a.navia-link').on('click', function navhat_click(evt) {\n      // are we in \"mobile nav / xs width\" mode?\n      const xs = !$('#nav-tophat-helper:visible').length\n      const hat_open = $('#nav-tophat').hasClass('in')\n      const navlink = this\n\n      // determine mediatype from either: (1) user hit text or (2) user hit icon\n      const mt = ($(evt.target).attr('data-top-kind')  ||\n                  $(evt.currentTarget).attr('data-top-kind'))\n\n      const isnow = $('.navbar .dropdown-ia.hatted a').attr('data-top-kind')\n\n      if (!(xs  &&  hat_open  &&  isnow !== mt)) {\n        // show the links for mediatype clicked\n        $('.toprow').hide()\n        $(`.toprow.${mt}`).show()\n      }\n\n\n      if (!hat_open) {\n        $('#nav-tophat').collapse('show') // .. top hat is *not* open.  clicked, so open tophat\n\n        if (AJS.tophat_dont_count_first_open) {\n          delete AJS.tophat_dont_count_first_open\n        } else if (typeof archive_analytics !== 'undefined') {\n          // log that a user has opened the nav tophat, yayz\n          archive_analytics.send_ping({\n            kind: 'event',\n            ec: 'page_action',\n            ea: 'nav_tophat_galactica',\n            el: location.pathname,\n            cache_bust: Math.random(),\n          })\n        }\n      }\n\n\n      if (typeof isnow !== 'undefined')\n        log('isnow', isnow)\n      log('shouldB', mt)\n\n      if (isnow === mt) {\n        // 2nd click on same mediatype dropdown -- close tophat!\n        $('#nav-tophat').collapse('hide')\n        return false\n      }\n\n      if (xs  &&  hat_open  &&  isnow !== mt) {\n        // Mobile/xs nav and user has clicked on *another* nav/MT icon.\n        // So we want to (animate) close the tophat, and when closed,\n        // reopen (animate) to the right open tophat -- this is because\n        // mobile/xs makes the tophat heights much more arbitrary\n        // and it looks weird hard jumping to other open area at another height!\n        $('#nav-tophat').one('hidden.bs.collapse', () => {\n          setTimeout(() => $(navlink).click(), 100)\n        })\n        $('#nav-tophat').collapse('hide')\n        return false\n      }\n\n\n      $('.navbar .dropdown-ia').removeClass('hatted').has(`.${mt}`).addClass('hatted')\n      $('#nav-tophat').on('hidden.bs.collapse', () => $('.navbar .dropdown-ia').removeClass('hatted'))\n\n\n      // any click makes tophat hide...\n      $(document).one('click.tophat.nixer', (event) => {\n        const $e = $(event.target)\n        // log($e)\n        if ($e.attr('id') === 'nav-wb-url')\n          return // ... except clicking on wayback machine form input\n        if ($e.is('a'))\n          return // ... except clicking on a link\n        if ($e.hasClass('item-img')  ||  $e.hasClass('item-ia'))\n          return\n\n        // NOTE: if not open, we wont hide\n        $('#nav-tophat.in').collapse('hide')\n      })\n\n      return false\n    })\n  }\n\n\n  static isTouchDevice() {\n    return ('ontouchstart' in window ||\n            (window.DocumentTouch && document instanceof window.DocumentTouch))\n  }\n\n\n  static footer() {\n    if (!AJS.isTouchDevice()  &&  typeof $.fn.tooltip !== 'undefined') {\n      $('.navbar [data-toggle=\"tooltip\"], .container-ia [data-toggle=\"tooltip\"], #cols [data-toggle=\"tooltip\"], #tvbanner [data-toggle=\"tooltip\"]').tooltip({\n      })\n      // $('body').addClass('glyphs-as-text')\n    }\n  }\n\n\n  static wrapdark_watcher() { // no longer needed/used but has some handy techniques...\n    if (!AJS.$sharedown) {\n      AJS.$sharedown = $('#sharedown')\n      AJS.$wrapdark  = $('#wrapdark')\n    }\n\n    // every second, sigh, check/adjust for the wrapdark height\n    if (!AJS.wrapdark_watcher_ptr)\n      AJS.wrapdark_watcher_ptr = setInterval(AJS.wrapdark_watcher, 1000)\n\n    if (!AJS.$sharedown.length  ||  !AJS.$wrapdark.length) {\n      clearInterval(AJS.wrapdark_watcher_ptr)\n      return\n    }\n\n    const wrapdarkHT = AJS.$sharedown.offset().top + AJS.$sharedown.find('.panel-heading').innerHeight()\n    if (parseInt(AJS.$wrapdark.css('height'), 10) !== wrapdarkHT) {\n      AJS.$wrapdark.css({ height: wrapdarkHT }).show()\n      log('       WRAPDARK-ED to ', wrapdarkHT)\n    }\n  }\n\n\n  static mute_click() {\n    const mutedNOW = !$.cookie('unmute')\n\n    if (this.emulator) {\n      this.emulator.setMute(!mutedNOW)\n    } else {\n      const player = jwplayer('jw6')\n      if (player) {\n        const volnow = player.getVolume()\n        if (volnow) {\n          AJS.mute_click_prior_volume = volnow\n          player.setVolume(0)\n        } else {\n          player.setVolume(typeof AJS.mute_click_prior_volume === 'undefined' ? 100 :\n            AJS.mute_click_prior_volume)\n        }\n      }\n    }\n\n\n    $('#theatre-ia .iconochive-mute, #theatre-ia .iconochive-unmute').toggle()\n\n\n    if (mutedNOW) {\n      // sounds is off.  make it loud\n      $.cookie('unmute', 1, { path: '/details', expires: 30 })\n    } else {\n      // sounds is on.  mute it!\n      $.cookie('unmute', null, { path: '/details' })\n    }\n\n\n    return false\n  }\n\n\n  static emulate_setup(game) {\n    // eslint-disable-next-line  no-param-reassign\n    game.toString = (() => game.identifier)\n    AJS.emulator = new IALoader(\n      $('#canvas').get(0), game, null,\n      (game.scale ? parseFloat(game.scale) : 1),\n      (game.module.indexOf('dosbox') === 0 ? '/images/dosbox.png' : '/images/mame.png'),\n    )\n\n\n    $('#theatre-ia .iconochive-unmute, #theatre-ia .iconochive-mute').hide()\n    if ($.cookie('unmute')) {\n      $('#theatre-ia .iconochive-unmute').show()\n      AJS.emulator.unmute()\n    } else {\n      $('#theatre-ia .iconochive-mute').show()\n      AJS.emulator.mute()\n    }\n\n    AJS.theatre_controls_position()\n    $(window).on('resize  orientationchange', () => {\n      clearTimeout(AJS.theatre_controls_position_throttler)\n      AJS.theatre_controls_position_throttler = setTimeout(AJS.theatre_controls_position, 250)\n    })\n  }\n\n\n  static emulate() {\n    /* global  canvas  IALoader  DOSBOX  JSMESS  Module */\n\n    // move the virtual keyboard thing and give it a \"go away!\" button\n    $('.ui-keyboard').prepend(`\n      <button style=\"position:relative;top:-5px;right:-8px;\" type=\"button\" class=\"close\"\n              onclick=\"$('.ui-keyboard').removeClass('showing').hide()\" aria-hidden=\"true\">\n        <span class=\"iconochive-remove-circle\"></span></button>`)\n      .appendTo($('#emulate .posrel')).addClass('showing')\n\n    $('#jsmessSS').fadeOut('slow')\n    $('#canvasholder').css('visibility', 'visible')\n    AJS.emulator.start({ hasCustomCSS: true })\n\n    // setup the theatre-ia fullscreen button\n    const EM = (JSMESS  ||  DOSBOX  ||  false)\n    if (EM  &&  (canvas.webkitRequestFullScreen || canvas.mozRequestFullScreen ||\n                  canvas.requestFullScreen)) {\n      $('#gofullscreen').on('click', () => Module.requestFullScreen(1, 0))\n      /**/ if ('onfullscreenchange'       in document) document.addEventListener('fullscreenchange',       EM.fullScreenChangeHandler)\n      else if ('onmozfullscreenchange'    in document) document.addEventListener('mozfullscreenchange',    EM.fullScreenChangeHandler)\n      else if ('onwebkitfullscreenchange' in document) document.addEventListener('webkitfullscreenchange', EM.fullScreenChangeHandler)\n    }\n\n    setTimeout(AJS.theatre_controls_position,   100)\n    setTimeout(AJS.theatre_controls_position,   500)\n    setTimeout(AJS.theatre_controls_position,  3000)\n    setTimeout(AJS.theatre_controls_position, 10000)\n\n    return false\n  }\n\n\n  static theatre_controls_position($selectorIn, pegTop, widthIn, heightIn) {\n    // We have lots of callers!  video, software, texts.\n    // So sort out our args and where we gonna \"peg\"/glue things to...\n    let $selector = $selectorIn\n    const video = (heightIn  &&  !$selectorIn)\n    if (!video) {\n      if (!$selectorIn) $selector = $('#canvas') // software emulation\n      if (!$selector.length) return // protect against emulated embeds and undef...\n    }\n\n    const height = (video ? heightIn : $selector.height())\n    const width  = (video ? widthIn  : $selector.width())\n\n    if (!video  &&  typeof pegTop !== 'undefined')\n      $('#theatre-controls').offset({ top: pegTop })\n\n\n    // Subtract out the width of the controls to get total amount of black pixels\n    // to the right of the theatre object.\n    // We want to position the controls in the middle of the dark pixels / right gutter!\n    const right_gutter_width =\n      Math.round(($('#theatre-ia-wrap').width() - $('#theatre-controls').width() - width) / 2)\n\n    log('width', width)\n    log('right_gutter_width', right_gutter_width)\n\n\n    $('#theatre-controls').css({\n      height,\n      visibility: 'visible',\n      right: Math.max(20, right_gutter_width / 2),\n    })\n  }\n\n\n  static booksize() {\n    if (!$('#texty').length)\n      return\n\n    // Use the standard theatresize function\n    AJS.theatresize()\n\n    const pollingMillis = 200\n\n    // Change the bg in the iframe\n    const $textyiframe = $('#texty iframe')\n    const changeBgColor = () => {\n      const $contentDom = $($textyiframe.get(0).contentDocument)\n      const $match = $contentDom.find('#BookReader')\n      if ($match.length > 0) {\n        $contentDom.find('body, #BookReader').css('background-color', 'transparent')\n        return true\n      }\n      return false\n    }\n    if (!changeBgColor()) {\n      const bgColorInterval = setInterval(() => {\n        if (changeBgColor())\n          clearInterval(bgColorInterval)\n      }, pollingMillis)\n    }\n\n    // Setup the controls\n    // NOTE The attribute data-lendable-book is added in Details.inc\n    const isLendableBook = typeof $('#texty').data('lendable-book') !== 'undefined'\n    if (!isLendableBook && !AJS.booksize_controls_hidden) {\n      AJS.booksize_controls()\n      const bookSizeInterval = setInterval(() => {\n        if (!AJS.booksize_controls_hidden)\n          AJS.booksize_controls()\n        else\n          clearInterval(bookSizeInterval)\n      }, pollingMillis)\n    }\n  }\n\n  // Hides the book controls, per david!\n  // Also positions the \"theatre controls\"\n  static booksize_controls() {\n    const $iframe = $('iframe:first')\n    if (!$iframe.length)\n      return\n    const $iframeDOM = $($iframe.get(0).contentDocument)\n    if (!$iframeDOM.length)\n      return\n\n    if (!AJS.booksize_controls_hidden) {\n      if (!$iframeDOM.find('#BRnav').length) {\n        log('BOOK NOT READY YET')\n        return\n      }\n      if ($iframeDOM.find('#BRtwopageview').length > 0) {\n        // Only hide nav in 2up. Show it in 1up\n        $iframeDOM.find('#BRnav').hide()\n      }\n      AJS.booksize_controls_hidden = true\n      $('#texty iframe').css('visibility', 'visible')\n      log('BOOK CONTROLS HIDDEN!')\n    }\n\n    $iframeDOM.find('body, #BookReader').css('background-color', 'transparent')\n\n    // now position the theatre controls\n    const $book = $iframeDOM.find('#BRtwopageview, #BRpageview')\n\n    // compute where the logical top point should be for the book and for the controls\n    // (which is comparable to A/V items)\n    const $navbar = $('.navbar')\n    // NOTE: we *do* check the nav top (almost always 0!) for rare cases we have a banner\n    // *ABOVE* the navbar, eg: EOY donate banner campaign (which is above the nav)!\n    const pegTop = ($navbar.offset().top + $navbar.height() +\n                    parseInt($('#texty').css('padding-top'), 10))\n    AJS.theatre_controls_position($book, pegTop)\n    log('book top', $iframe.offset().top + $book.offset().top, ' -v- pegTop', pegTop)\n\n    // and now dont overflow negative margin-bottom blackness into metadata section\n    $('#theatre-ia').css({ overflow: 'hidden' })\n  }\n\n\n  static popcornsize() {\n    const resizer = () => {\n      const metadataHeight = 100 // metadata peekaboo min height!\n      const maxH = $(window).height() - $('iframe:first').offset().top - metadataHeight\n      const maxW = $('#theatre-ia .row').outerWidth()\n      // make max height at most 16x9 ratio (43px is the popcorn controls height)\n      const WH = { width: maxW, height: Math.min(maxH, ((maxW * 9) / 16) + 43) }\n      log('popcorn resize: ', WH)\n      $('iframe:first').css(WH) // resize popcorn\n    }\n    resizer() // page load event is now\n    $(window).on('resize  orientationchange', () => {\n      clearTimeout(AJS.popcorn_throttler)\n      AJS.popcorn_throttler = setTimeout(resizer, 250)\n    })\n  }\n\n\n  /**\n   * A general purpose theatre sizing function.\n   * It keeps the metadata below the theatre partially visible.\n   * @param {function} onChange - called when size changes\n   * @global AJS.theatresize_maxheight if this is set by another\n   *   part of the code, it will contrain to this max height.\n   */\n  static theatresize(onChange) {\n    if (!AJS.theatresize_maxheight)\n      AJS.theatresize_maxheight = null\n    const resizer = () => {\n      const metadataHeight = 100 // metadata peekaboo min height!\n      const maximumHeight = 1000 // don't get larger than this\n      const minHeight = Math.min($(window).width(), 400)\n      let targetHeight = $(window).height() - $('#navwrap1').height() - metadataHeight\n\n      if (AJS.theatresize_maxheight)\n        targetHeight = Math.min(targetHeight, AJS.theatresize_maxheight)\n\n      targetHeight = Math.max(targetHeight, minHeight)\n      const height = Math.min(targetHeight, maximumHeight)\n      $('#theatre-ia-wrap').addClass('resized').css('height', height)\n\n      if (onChange)\n        onChange($('#theatre-ia-wrap').height())\n    }\n    resizer() // page load event is now\n    $(window).on('resize  orientationchange', () => {\n      clearTimeout(AJS.theatresize_throttler)\n      AJS.theatresize_throttler = setTimeout(resizer, 250)\n    })\n  }\n\n  /**\n   * Will reduce the vertical size of the carousel once all the images have\n   * downloaded and only if they are all smaller than the current size.\n   * This is a progressive enhancement\n   * @param string selector\n   * @param bool enableThreatreChange\n   */\n  static carouselsize(selector, enableThreatreChange) {\n    const $carousel = $(selector)\n    const imagePromises = $carousel.find('img.carousel-image').map((i, img) => {\n      const promise = $.Deferred()\n      let result\n      if (img.complete) {\n        result = promise.resolve(img.naturalHeight).promise()\n      } else {\n        img.addEventListener('load', () => {\n          promise.resolve(img.naturalHeight)\n        })\n        result = promise\n      }\n      return result\n    })\n    $.when(...imagePromises).then((...args) => {\n      const currHeight = $carousel.height()\n      const maxImageHeight = Math.max(...args)\n      if (currHeight > maxImageHeight) {\n        $carousel.css('maxHeight', maxImageHeight)\n        if (enableThreatreChange) {\n          AJS.theatresize_maxheight = maxImageHeight\n          $(window).trigger('resize')\n        }\n      }\n    })\n  }\n\n  static pause(id = 'jw6') {\n    const jw = jwplayer(id)\n    if (jw  &&  jw.getState  &&  jw.getState().toLowerCase() === 'playing')\n      jw.pause()\n  }\n\n\n  static morf(lnk, switchToA2Z) { // MORe Facets\n    const href = $(lnk).attr('href')\n\n    if (switchToA2Z  &&  switchToA2Z[0] === '-')\n      $.cookie(switchToA2Z.substr(1).concat('A2Z'), 1, { path: '/', expires: 1 })\n    else if (switchToA2Z)\n      $.cookie(switchToA2Z.concat('A2Z'), null, { path: '/', expires: 1 })\n\n\n    const props = { selectorID: 'morf-modal' }\n    const selector = `#${props.selectorID}`\n\n    const contents = (\n      <div className=\"modal-dialog\">\n        <div className=\"modal-content\">\n          <div className=\"modal-header modal-header-std\">\n            <button type=\"button\" className=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">\n              <span className=\"iconochive-remove-circle\" />\n            </button>\n            {/* eslint-disable  jsx-a11y/heading-has-content */}\n            <h2 className=\"modal-title\" />\n            {/* eslint-enable   jsx-a11y/heading-has-content */}\n          </div>\n          <div className=\"modal-body\" id={props.selectorID.concat('-body')} />\n        </div>\n      </div>)\n    if (!$(selector).length)\n      $('body').prepend($(`<div id=\"${props.selectorID}\" class=\"modal fade\" role=\"dialog\" aria-hidden=\"true\"/>`))\n\n    ReactDOM.render(contents, $(selector).get(0))\n    $(selector).modal('show')\n\n    ReactDOM.render(<AJS.MORFreact href={href} />, $(`${selector}-body`).get(0))\n\n    return false\n  }\n\n  static add2list(lnk) {\n    const href = $(lnk).attr('href')\n\n    $.get(`${href}&headless=1&titlelist=${$(lnk).text()}`, (htm) => {\n      // dynamically add modal to page (if isnt there already)\n      AJS.modal_go(lnk, {\n        title: 'Add To List',\n        headerClass: 'modal-header-new-list',\n        ignore_lnk: true,\n        auto_remove: true,\n        body: htm,\n      })\n    })\n\n    return false\n  }\n\n  static newlist(lnk) {\n    const href = $(lnk).attr('href')\n\n    $.get(href.concat('&headless=1'), (htm) => {\n      // dynamically add modal to page (if isnt there already)\n      AJS.modal_go(lnk, {\n        title: 'Create New List',\n        headerClass: 'modal-header-new-list',\n        ignore_lnk: true,\n        body: htm,\n      })\n    })\n\n    return false\n  }\n\n  static newlist_submit() {\n    // Strings with SPACE characters will be changed to \"camel case\".\n    // For example:\n    //    \"my LA roadtrip\"\n    // will become:\n    //    \"MyLaRoadtrip\"\n    // Letters, numbers, periods (.), dashes (-), or underscores (_) are ok, but\n    // other characters will be removed.\n    const title = $('#new-list-form input[name=title]').val()\n    if (!title.length) {\n      // eslint-disable-next-line  no-alert\n      alert('Please enter a title for your List')\n      return false\n    }\n\n    // turn the title into an acceptable identifier\n    // (1) remove any \"bad\" chars\n    // (2) trim any *leading* chars like:  - _ .\n    const cleaned = title.replace(/[^a-zA-Z0-9_\\-.]/g, '').replace(/^[_\\-.]+/, '')\n    log(cleaned)\n\n    if (!cleaned.length) {\n      // eslint-disable-next-line  no-alert\n      alert('Please try another title that contains more alphanumeric characters')\n      return false\n    }\n\n    return true\n  }\n\n  static popover_menu(selector, opts) {\n    // setup options\n    const options = {\n      trigger: 'hover focus click', // make accessible\n      container: selector,\n      content: opts.content,\n      html: true,\n    }\n    // do not overwrite values given by the 'data-' attribute\n    if (opts.title)\n      options.title = opts.title\n    if (opts.placement)\n      options.placement = opts.placement\n    if (opts.trigger)\n      options.trigger = opts.trigger\n\n    // setup popover\n    $(selector).popover(options)\n  }\n\n\n  // makes the tooltip show for picking dates\n  static date_switcher(htm) {\n    const selector = '#date_switcher'\n\n    // make a tooltip trigger manually, on hover, but then *hold it showing*\n    // until they leave area *including* tooltip itself\n    $(selector).tooltip({\n      html: true,\n      trigger: 'manual', // we gonna control hover behaviour\n      placement: 'bottom',\n      title: htm,\n    }).on('mouseenter focusin', function date_switcher_hover() {\n      // check first if already showing, to avoid \"flickering\" with \"show! .. show!\"\n      if (!($(selector).parent().find('.tooltip').length))\n        $(this).tooltip('show')\n    })\n\n\n    // the date_switcher lives inside bigger \"sortbar\".  the date changing tooltip\n    // lives inside it (and hangs off it).  So what we *really* want as the trigger\n    // to hide the date change tooltip is the entire sortbar itself.  nice!\n    $('.sortbar').on('mouseleave', () => {\n      log('not hovering sortbar anymore')\n      $(selector).tooltip('hide')\n    })\n\n\n    $(selector).on('shown.bs.tooltip', () => {\n      // make any link hit change which one is \"in\"\n      // (just before page starts to reload)  finesse!\n      $(selector).parent().find('.date_switcher').on('click', function date_switcher_click() {\n        $(this).parents('.tooltip').find('.date_switcher.in').removeClass('in')\n        $(this).addClass('in')\n      })\n    })\n  }\n\n\n  // NOTE: UNUSED BUT KEPT IN CASE WE EVER GO BACK FROM NEWER/BETTER CSS-ONLY SOLUTION!\n  //\n  // [ Now we use CSS to (max-/)width C2 and C4 *instead* for a much better user experience\n  //   AND for a more efficient / kinder to browser non-JS solution! ]\n  static tiles_to_list() {\n    /*\n      First, allow natural HTM/CSS widths of 3 of 5 \"table-cell\" display type columns\n        C1         C234      C5\n        VIEWS  ..  DATE  ..  MT-ICON\n\n        Compute width of \"C234\" - width of C3/DATE.\n        Split TITLE (C2) and CREATOR (C4) max-width into\n        60% / 40% split of that #pixels.\n    */\n\n    // NOTE: there can be 2+ sets of results on a page -- eg: \"My Library\" page!\n    const selector = AJS.selector()\n    const $selector = $(selector).first()\n    log('lister() SELECTOR', selector)\n\n    const C3   = $selector.find('.results .item-ia:first   .C3').outerWidth()\n    const C234 = $selector.find('.results .item-ia:first .C234').outerWidth()\n\n    // the \"-20\" was empirically observed / made up -- get some science, girl!\n    const availWidth = (C234 - C3) - 20\n    const C2 = Math.max(80, Math.round(0.6 * availWidth))\n    const C4 = Math.max(80, Math.round(0.4 * availWidth))\n    log('C3  ',   C3)\n    log('C234', C234)\n    log('C2  ',   C2)\n    log('C4  ',   C4)\n    log(' ==> availWidth: ', availWidth, '(', C2, '+', C4, ')')\n\n    $selector.find('.results .item-ia .C2').css({ width: C2, 'max-width': C2 })\n    $selector.find('.results .item-ia .C4').css({ width: C4, 'max-width': C4 })\n  }\n\n\n  // We moved to newer tactic Mar2015...\n  // Pages are emitted by default with body classes \"lists\" and \"showdetails\".\n  // We use JS to toggle/remove them and switch off details or switch to \"tiles\" mode.\n  static lists_v_tiles_setup(cookie_range) {\n    // does user have any cookied preferences?\n    const defaults    = 'tiles' // (cookie_range === 'search' ? 'lists' : 'tiles')\n    const prefer      = ($.cookie(`view-${cookie_range}`))\n    const showdetails = ($.cookie(`showdetails-${cookie_range}`))\n\n    const checked = (showdetails === 'showdetails'  ||\n                      (showdetails === null  &&  defaults === 'lists'))\n\n    if (prefer === 'lists'  ||  (!prefer  &&  defaults === 'lists')) {\n      if (checked)\n        return // perfect, we are already what they want\n      $('body').removeClass('showdetails') // they dont want full details right now\n    } else {\n      // switch to \"tiles\" mode\n      $('body').removeClass('lists'.concat(checked ? '' : ' showdetails')).addClass('tiles')\n    }\n  }\n\n\n  static showdetails_toggle(btn, cookie_range) {\n    const $body = $('body')\n\n    const to = ($body.hasClass('showdetails') ? '' : 'showdetails')\n    log('showdetails_toggle() going to: ', to)\n\n    $.cookie(`showdetails-${cookie_range}`, to, { path: '/', expires: 30, domain: '.archive.org' })\n\n    $body.toggleClass('showdetails')\n  }\n\n\n  static tiles_toggle(btn, cookie_range) {\n    const $body = $('body')\n\n    const to = ($body.hasClass('tiles') ? 'lists' : 'tiles')\n    log('tiles_toggle() going to', to)\n\n    $body.removeClass('lists tiles').addClass(to)\n    AJS.tiler()\n\n    $.cookie(`view-${cookie_range}`, to, { path: '/', expires: 30, domain: '.archive.org' })\n\n    return false\n  }\n\n\n  // Returns one of these, like \"#ikind-[IKIND]\"\n  //\n  // COLLECTION PAGES, ACCOUNT PAGES:\n  //\n  //   #ikind--downloads\n  //   #ikind--titleSorter\n  //   #ikind--publicdate\n  //   #ikind--date\n  //   #ikind--reviewdate\n  //   #ikind--updatedate\n  //   #ikind--creatorSorter\n  //\n  //   #ikind-downloads\n  //   #ikind-titleSorter\n  //   #ikind-publicdate\n  //   #ikind-date\n  //   #ikind-reviewdate\n  //   #ikind-updatedate\n  //   #ikind-creatorSorter\n  //\n  // ACCOUNT PAGES (additionally):\n  //\n  //   #ikind-loans-waiting-list\n  //   #ikind-loans-on-loan\n  //   #ikind-loans-history\n  //\n  // OTHER:\n  //\n  //   #ikind-search              (search)\n  //\n  static selector() {\n    const inTab = $('.welcome .tabby.in .tabby-text')\n      .first()\n      .text()\n      .toLowerCase()\n      .trim()\n    if (inTab === 'forum'  ||  inTab === 'posts'  ||  inTab === 'about')\n      return false // no tab of tiles are showing\n\n    let selector = false\n    if (inTab) {\n      // We want to end up with a selector like:\n      //    #ikind-collections-title\n      //    #ikind--publicdate\n      log('inTab', inTab)\n      const tmp = `#tabby-${inTab.replace(' ', '-')}`\n      if (inTab === 'collection'  ||  inTab === 'collections'  ||  inTab === 'uploads' || inTab === 'reviews' || inTab === 'web archives') {\n        selector = '#'.concat($(tmp.concat(' div.ikind.in:first')).attr('id'))\n      } else {\n        const ikind = $(tmp.concat(' .ikind.stealth.in:first')).text().toLowerCase().replace(/ /, '-')\n        selector = `#ikind-${inTab}${ikind === '' ? '' : '-'}${ikind}`\n      }\n    } else {\n      // we want to end up with a selector like:\n      //    #ikind-date\n      selector = '#ikind-'.concat($('.ikind.stealth.in:first').text().toLowerCase().replace(/ /, '-'))\n      if (!$(selector).length) selector = '#ikind-search' // xxx  SHORE THIS UP, GIRL!\n    }\n\n    log('SELECTOR', selector)\n\n    return selector\n  }\n\n\n  // function that finds alternate (non-AJS.tiler()) sets of item tiles,\n  // that are laid out in strips/columns and will hide entire columns\n  // if they fall off the right side, in terms of fitting to browser/page width\n  static tilebars() {\n    // iterate over all row classes that have at least 1 .tilebars .results div in them...\n    $('.row .tilebars').find('.results').parents('.row').each((k, row) => {\n      let first = false\n      $(row).find('.results').each((key, val) => {\n        $(val).show().css({ visibility: 'hidden' })\n        if (!first)\n          first = $(val).offset()\n        if ($(val).offset().top !== first.top)\n          $(val).hide()\n        else\n          $(val).css({ visibility: 'visible' })\n      })\n      // if (first) $(row).find('.tilebars > h4').css({'padding-left':first.left+10})\n    })\n  }\n\n\n  // adds collection parent hovering image and text to tiles\n  static parent_hover($selector) {\n    $selector.find('.item-ia:not(.hov):not(.collection-ia):not(.account-ia)').addClass('hov')\n      .mouseover((e => $(e.currentTarget).find('.item-parent').addClass('hoverin')))\n      .mouseout((e  => $(e.currentTarget).find('.item-parent').removeClass('hoverin')))\n  }\n\n\n  static tiler(selectorIn, noRecall) {\n    const tileMarginH = 30\n    const tileMarginW = 17\n\n\n    // See lister() for why this is able to be commented out now!\n    // $('.results .item-ia .C2, .results .item-ia .C4').css({'width':'','max-width':''});\n    if (!$('body').hasClass('tiles')) {\n      if ($('body').hasClass('showdetails'))\n        $('.sortbar input[name=showdetails]').prop('checked', true)\n      // AJS.lister()\n    }\n\n    const selector = (selectorIn  ||  AJS.selector())\n    if (selector === false)\n      return\n\n\n    const $selector = $(selector).first()\n    const selectorID = $selector.attr('id')\n    const $parentRow = $selector.parents('.row')\n\n    // CSS Grid tiler experiment.  OFF/unused.\n    // This could be a way to drop much of the JS to do our 'masonic' tiling by leveraging\n    // CSS Grid row 'strips' and space the tile to the closest overall height of narrow rows\n    // instead of JS-based calculations for absolute 'top' positioning.\n    const cssGrid = (false  &&  $('body').hasClass('devbox')  &&  CSS.supports('display', 'grid'))\n\n\n    if (!$('body').hasClass('tiles')) {\n      $parentRow.css({ 'padding-left': '', 'padding-right': '' })\n      return\n    }\n\n\n    if (!AJS.tilerPREV) {\n      // first time tiling page!\n      AJS.tilerPREV = {\n        winW: 0,\n        pad: 0,\n        nPerRow: 1,\n        gutter: tileMarginW,\n        tileWidth: AJS.TILE_WIDTH,\n        unsourced: {},\n        firstLeft: 0,\n      }\n\n      AJS.parent_hover($selector)\n    }\n\n    if ($(window).width() !== AJS.tilerPREV.winW) {\n      // First time, or page resize/orientation change.\n      // We will effectively \"cache\" all this adjusting computations, so multiple calls to tiler()\n      // can reuse if window width hasnt changed\n      // (for efficiency, eg: many images still slowly loading..)\n      $parentRow.css({ 'padding-left': '', 'padding-right': '' }) // reset (see below)\n      AJS.tilerPREV.firstLeft = 0  // reset (see below)\n\n      const $facets = $parentRow.find('.columns-facets:visible')\n      let facetsWidth = $facets.outerWidth()  ||  0\n      if (facetsWidth)\n        facetsWidth += 1 + parseInt($facets.css('padding-right'), 10) // add columns-items gutter\n      const availWidth = $parentRow.width() - facetsWidth\n      const gutter = (availWidth < 400 ? 5 : tileMarginW)\n      const tileWidth = ($('.item-ia:first').outerWidth() >= AJS.TILE_WIDTH ? AJS.TILE_WIDTH : AJS.TILE_WIDTH_SMALL)\n      const nPerRow = Math.max(1, Math.floor((availWidth + gutter) / (tileWidth + gutter)))\n      const extra   = Math.max(0, (availWidth - (nPerRow * (tileWidth + gutter))) + gutter)\n\n      log(\n        'tiling', selectorID,\n        'parentRowW', $parentRow.width(),\n        'facetsWidth', facetsWidth,\n        'availWidth: ', availWidth,\n        'number per row', nPerRow, '. ',\n        'With gutter margin', gutter,\n        'had ', extra, 'extra pixels',\n      )\n      AJS.tilerPREV.pad = Math.round(extra / 2)\n\n      AJS.tilerPREV.winW = $(window).width()\n      AJS.tilerPREV.nPerRow = nPerRow\n      AJS.tilerPREV.gutter = gutter\n      AJS.tilerPREV.tileWidth = tileWidth\n    }\n\n    if (!cssGrid) {\n      if (AJS.tilerPREV.nPerRow > 1)\n        $parentRow.css({ 'padding-left': AJS.tilerPREV.pad, 'padding-right': AJS.tilerPREV.pad })\n      else\n        AJS.tilerPREV.firstLeft = AJS.tilerPREV.pad\n    }\n\n    let nImgZeroHeight = 0\n    const nImgZeroHeightAry = []\n    let maxtop = 0\n    const tops = { 0: 0 }\n    const lefts = { 0: AJS.tilerPREV.firstLeft }\n    if (!cssGrid) {\n      for (let i = 1; i < AJS.tilerPREV.nPerRow; i++) {\n        lefts[i] = lefts[i - 1] + AJS.tilerPREV.gutter + AJS.tilerPREV.tileWidth\n        tops[i] = 0\n      }\n    }\n\n\n    // Any item tiles w/ unloaded/set src tags get updated and loaded now!\n    // Only have to do this pass on a swathe of new results (1st page or infin scroll set added)\n    if (!AJS.tilerPREV.unsourced[selectorID]) {\n      log('unsourcing', selectorID)\n      // eslint-disable-next-line  prefer-arrow-callback\n      $selector.find('.item-ia img[source]').each(function tiler_unsourcing(k, v) {\n        $(v).attr({\n          src: $(v).attr('source'),\n          onError: '$(this).attr(\"src\",\"/images/notfound.png\")',\n        }).removeAttr('source')\n      })\n      AJS.tilerPREV.unsourced[selectorID] = 1\n    }\n\n\n    if (cssGrid)\n      $selector.find('.results').removeClass('grid-tiles') // we need to let tiles size naturally first\n    else\n      AJS.colPREV = -1 // we track where previous tile was placed\n\n    $selector.find('.item-ia').not('.mobile-header').css('visibility', 'hidden').each((idx, val) => {\n      const $val = $(val)\n      const $valHT = $val.innerHeight()\n      // log('$valHT', $valHT)\n\n      const css = {}\n      if (cssGrid) {\n        log(`${$valHT} span: ${Math.ceil(($valHT + 25) / 35)}`)\n        css['grid-row-end'] = `span ${Math.ceil(($valHT + 25) / 35)}`\n      } else {\n        let col = 0\n        if (AJS.tilerPREV.nPerRow > 1  &&  idx >= AJS.tilerPREV.nPerRow) {\n          // First, cycle from last placed tile column location to \"first cycled slot\".\n          // (That is, move \"1 to right\" from last placed tile column, but it's a cycle/ring\n          // for final column -- go to 1st column in that case).\n          // Test place new tile *there* (in \"first cycled slot\") UNLESS further ahead in\n          // cycle/ring of other slots, the tile will fit where its BOTTOM will be above where\n          // tile TOP would be in the \"first cycled slot\".\n          // (and pick the \"first\" in such a case if 2+ slots like that)\n          const colTEST = ((AJS.colPREV + 1)  %  AJS.tilerPREV.nPerRow)\n          col = colTEST // fallback/default\n          const cmpTEST = tops[colTEST] - $valHT // [slightly more efficient way 2 compare]\n          for (let i = 0; i < AJS.tilerPREV.nPerRow; i++) {\n            if (i !== colTEST  &&  cmpTEST > tops[i]) {\n              col = i\n              break\n            }\n          }\n        } else {\n          col = (idx % AJS.tilerPREV.nPerRow)\n        }\n        AJS.colPREV = col\n        css.visibility = 'visible'\n        css.top  =  tops[col]\n        css.left = lefts[col]\n\n        // setup for next tile...\n        tops[col] += ($valHT + tileMarginH)\n\n        maxtop = Math.max(maxtop, tops[col])\n      }\n\n      $val.css(css)\n\n\n      // track how many tile images are without height\n      // (either not loaded or no CSS height style set if img not loading from DB)\n      let tmp = $val.find('.item-img')\n\n      if (tmp.length  &&  !($val.find('.item-img').height())) {\n        nImgZeroHeight += 1\n        tmp = $val.attr('data-id')\n        if (tmp)\n          nImgZeroHeightAry.push(tmp)\n      }\n    })\n\n    if (cssGrid) {\n      $selector.find('.results').addClass('grid-tiles')\n      $selector.find('.item-ia').css({ visibility: 'visible' })\n    } else {\n      // we have to manually set the height of the \"selector\"\n      log('maxtop', maxtop)\n      $selector.find('.results').css({ height: maxtop })\n    }\n\n\n    if ($('body').hasClass('manage')) {\n      $('.item-ia:not(.removable)').addClass('removable').append(`\n        <div class=\"xer\" onclick=\"return AJS.unmanage(this)\" title=\"remove item from being submitted to item management\"></div>`)\n    }\n\n\n    if ((nImgZeroHeight)  &&  !noRecall) {\n      log(\n        nImgZeroHeight, ' img (still w/o height); recall tiler(', selector, ')...',\n        nImgZeroHeightAry.join(','),\n      )\n      // recall ourselves, but not more than once every 1.5 seconds!\n      clearTimeout(AJS.tiler_throttler)\n      AJS.tiler_throttler = setTimeout(() => AJS.tiler(selector, 0), 1500)\n    }\n  }\n\n\n  static ikind(lnk, id) {\n    const idsel = `#${id}`\n    log('ikind', id)\n    $(idsel).parent().find('div.ikind.in').hide()\n    $(idsel).removeClass('hidden').addClass('in').show()\n    $(idsel).parents('.tabby-data').find('a.ikind').removeClass('in')\n\n    $(lnk).addClass('in')\n\n    AJS.tiler(idsel)\n\n    // now select the corresponding element in the shadowing select for mobile\n    const $sel = $(idsel).parents('.tabby-data').find('select.ikind-mobile')\n    const $new = $sel.find('option:contains('.concat($(lnk).text(), ')'))\n    const $now = $sel.find('option:selected')\n    if ($new.text().trim() !== $now.text().trim()) {\n      log('changing ikind mobile now to ', $new.text())\n      AJS.ikind_mobile_change_ignore_next = true\n      $new.attr('selected', 'selected')\n      // $now.removeAttr('selected')\n    }\n\n    return false\n  }\n\n  static ikind_mobile_change(elm) {\n    if (AJS.ikind_mobile_change_ignore_next) {\n      AJS.ikind_mobile_change_ignore_next = false\n      return\n    }\n\n    const $selopt = $(elm).find('option:selected')\n    log('ikind mobile changed to: ', $selopt.text())\n    let $ikinds = $(elm).parents('.tabby-data').find('a.ikind')\n    if (!$ikinds.length) {\n      // NO tabby!  eg: top page or search page\n      $ikinds = $('body').find('a.ikind')\n    }\n\n    if (!$ikinds.length)\n      return // uho!\n\n    const $ikind = $ikinds.filter((k, v) => $(v).text() === $selopt.text())\n\n    const href = $ikind.attr('href')\n    log('goto', href)\n\n    if (href) {\n      if (href.substr(0, 1) === '#') {\n        // ACCOUNT PAGE (FOR NOW)!  (STILL USES HASH FOR NOW)\n        $(`a.ikind[data-id=${href.substr(1)}]`).click()\n      } else {\n        location.href = href\n      }\n    }\n  }\n\n\n  static popState(pageType) {\n    // are we watching history.pushState() and history.popState() calls?\n    AJS.pushState = (typeof history.pushState !== 'undefined')\n    log('popState(', pageType, ') called, modern browser: ', (AJS.pushState ? 'y' : 'n'))\n\n    if (pageType) // anything custom we need to do based on pageType?\n      return\n\n\n    const tabPick = (hash2arg) => {\n      let tab = AJS.arg('tab', true)\n      if (tab)\n        tab = `#tabby-${tab}-finder`\n      else if (hash2arg)\n        tab = `#tabby-${hash2arg}-finder`\n      else\n        tab = '.tabby-default-finder'\n\n      if (AJS.pushState)\n        log('goto tab: ', tab, ' ################################################### STATE')\n      AJS.tabby_no_pushState_next_click = true\n      $(tab).click()\n    }\n\n    if (AJS.pushState) {\n      // runs on page load or browser \"back\":\n      $(window).on('popstate', () => tabPick())\n    }\n    // else user has an older browser or Opera Mini and doesn't have pushState/popState!\n\n    tabPick()\n  }\n\n\n  static tabby(lnk, id) {\n    log('AJS.tabby()', id)\n    const inTab = id.replace(/tabby-/, '').trim()\n    if (inTab === 'uploads' || inTab === 'reviews' || inTab === 'collections' || inTab === 'loans' || inTab === 'web archives') {\n      // account pages -- we need to fully reload page w/ new/wanted item tiles!\n      return true\n    }\n\n    // Only collection pages have tabs / proceed\n    // All three tabs have all the markup on the page already.\n    // So, for modern browsers, we will simply switch the visibile\n    // tab and update-in-place the url in the browser url typein\n    // -- WITHOUT refreshing the page.\n\n    $('.tabby-data.in').removeClass('in').hide()\n    $(`#${id}`).removeClass('hidden').addClass('in').show()\n    $('.tabby').removeClass('in')\n    $(lnk).parents('.tabby').addClass('in')\n\n    if (AJS.tabby_no_pushState_next_click) {\n      delete AJS.tabby_no_pushState_next_click\n    } else if (AJS.pushState  &&  typeof history.pushState !== 'undefined') {\n      const href = $(lnk).attr('href')\n      const locNOW = location.href\n      const locNEW = location.protocol.concat('//', location.host, href)\n      if (locNOW !== locNEW) {\n        log('pushState: ', href, ' ################################################### STATE')\n        history.pushState({}, '', locNEW)\n      }\n    }\n\n    if (inTab === 'collection'  ||  inTab === 'about') {  // collection pages\n      if (inTab === 'about')\n        AJS.grafs()\n      AJS.tiler()\n    }\n\n    if (AJS.pushState)\n      return false\n    return true\n  }\n\n\n  static colclick(e) {\n    const $e = $(e)\n    const id = $e.attr('data-id')\n\n    // *NORMALLY* clicking on a collection tile goes to it.\n    // BUT NOT:\n    //   * in lists mode (only the identifier link does that -- not other data columns!)\n    //   * if in process of removing items (eg: from favorites list)\n    if (id  &&  $('body').hasClass('tiles')  &&  !$e.hasClass('removable'))\n      location.href = `/details/${id}`\n  }\n\n  /**\n   * Processing to get related item using new API, Get response and Render using React component\n   */\n  static setUpRelatedItems() {\n    const alsoFoundElement  = $('#also-found-result')\n\n    // GET top offset of #also-found(related item section) and executing ajax call accordingly\n    if (alsoFoundElement.length !== 0) {\n      const $window = $(window)\n\n      const throttledListener = throttle(() => {\n        const alsoFound    = $('#also-found')\n        const topOffset    = alsoFound.offset().top\n        const windowHeight = $window.height()\n        // One half screen above the top of the element\n        const lazyLoadStart = topOffset - (windowHeight / 2)\n\n        if ($window.scrollTop() + windowHeight >= lazyLoadStart) {\n          if (alsoFoundElement.text() === '') {\n            // Show the tilebars, now that we've started loading\n            alsoFound.find('.tilebars').show()\n\n            ReactDOM.render(<AJS.LoadingMessage message=\"Fetching items\" />, alsoFoundElement[0])\n\n            AJS.doWhenScrolledToRelatedSection()\n              // Remove listener after it loads\n              .then(() => $window.off('scroll', throttledListener))\n          }\n        }\n      }, 100)\n\n      $window.scroll(throttledListener)\n    }\n  }\n\n  /**\n   * Get API response from AJS.getRelatedItems() after #also-found-result scrolled and\n   * render response using react component\n   *\n   * @return {Promise}\n   */\n  static doWhenScrolledToRelatedSection() {\n    const identifier = $('#also-found').data('identifier')\n    const alsoFoundElement = $('#also-found-result')\n\n    return AJS.getRelatedItems(identifier)\n      .then((response) => {\n        // Sending dataHash to React Componenet to render HTML of related items section\n        ReactDOM.render(<AJS.RelatedItemSection dataHash={response} />, alsoFoundElement[0])\n\n        // Set visibility:hidden of tiles for 2nd+ row esp. for narrower pages\n        AJS.tilebars()\n      })\n      .catch((error) => {\n        // Show messsage when similar items not found.\n        // Show the related items section, so we can display error\n        $('#also-found').show()\n        ReactDOM.render(<AJS.ErrorMessage errorMsg={error.message} />, alsoFoundElement[0])\n      })\n  }\n\n  /**\n   * API call to get related item and return response using Promise\n   *\n   * @param  {String} identifier item identifier\n   * @param  {Number} size number of item results (6 is the default)\n   * @return {Promise<Array|String>}\n   */\n  static getRelatedItems(identifier, size) {\n    return new Promise((resolve, reject) => {\n      const args = { size }\n      const apiUrl = `https://be-api.us.archive.org/mds/v1/get_related/all/${encodeURIComponent(identifier)}${(size ? `?${$.param(args)}` : '')}`\n      const hashData = []\n      let apiError = false\n\n      $.get(apiUrl, (response) => {\n        let items = []\n        try {\n          items = response.hits.hits\n          if (items.length === 0)\n            apiError = true\n        } catch (error) {\n          apiError = true\n        }\n\n        if (apiError) {\n          // Return error message to Promise when response is empty OR key not exists\n          reject(new Error('Similar items not found'))\n          return\n        }\n\n        items.forEach((item) => {\n          /* eslint no-underscore-dangle:\n          [error, { \"allow\": [\"_id\", \"_source\", \"_modal_add\"] }] */\n          const itemSource  = item._source\n          const singleHash  = {\n            identifier: item._id,\n            numReviews: 0,\n            lendingEnabled: false,\n            lendingAvailable: false,\n            loginRequired: false,\n            lendClass: '',\n            favorite: 0,\n            creator: '',\n          }\n\n          $.each(itemSource, (key, value) => {\n            if (key === 'downloads')\n              singleHash.downloads = [value[0]]\n\n            if (key === 'title')\n              singleHash.title = [value[0]]\n\n            if (key === 'mediatype')\n              singleHash.mediatype = [value[0]]\n\n            if (key === 'creatorSorter') {\n              // Replacing first character lower to CAPTIAL of each creator name.\n              // E.g goldsmith TO Goldsmith\n              value[0].replace(/\\w\\S*/g, (txt) => {\n                singleHash.creator += txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase().concat(' ')\n              })\n            }\n\n            if (key === 'collection') {\n              // Counting number of favorite colllections\n              value.forEach((val) => {\n                singleHash.favorite += (val.match(/fav-/g) || []).length\n              })\n\n              if (value.indexOf('loggedin') > 0)\n                singleHash.loginRequired = true\n            }\n\n            if (key === 'loans__status__status') {\n              singleHash.lendingEnabled = true\n              if (value[0] === 'AVAILABLE') {\n                singleHash.lendingAvailable  = true\n                singleHash.lendClass = 'lending-available'\n              } else {\n                singleHash.lendClass = 'lending-checked-out'\n              }\n            }\n\n            if (key === 'num_reviews')\n              singleHash.numReviews = [value[0]]\n          })\n\n          hashData.push(singleHash)\n        })\n        resolve(hashData) // Return related items hashData using Promise\n      }).error(() => {\n        reject(new Error('Similar items not found')) // Return error message to Promise when any error found\n      })\n    })\n  }\n\n\n  static list_remove_item(xer) {\n    if ($('body').hasClass('lists'))\n      $('.tiles-button:visible').click() // sorry!  only works in tiles mode now...\n\n\n    if (!xer) {\n      if (!$('.item-ia .xer').length) {\n        // make all items editable\n        $('.item-ia').addClass('removable').append('<div onclick=\"AJS.list_remove_item(this)\" class=\"xer\" alt=\"remove this item from list\" title=\"remove this item from list\"></div>')\n      } else {\n        // cancel editability\n        $('.item-ia').removeClass('removable')\n        $('.item-ia .xer').remove()\n      }\n    } else {\n      // single item is slated for utter destruction from the list...\n      const $item = $(xer).parents('.item-ia')\n      const idX = $item.attr('data-id')\n      let url = location.href.replace(/#.*$/, '').concat('?remove_item=', encodeURIComponent(idX))\n      // Use the most recent update date to help uniquely identify the item!\n      if ($item.attr('data-date'))\n        url += `&data-date=${$item.attr('data-date')}`\n      if (AJS.listkind)\n        url += `&kind=${AJS.listkind}`\n      log('GET', url)\n\n      $.get(url, (htm) => {\n        log('GOT', url)\n        log(htm)\n        $item.remove()\n        AJS.tiler()\n      })\n    }\n    return false\n  }\n\n\n  // remove an element from a search results page\n  static unmanage(xer) {\n    $(xer).parent('.item-ia').next().remove() // remove item list portion\n    $(xer).parent('.item-ia').remove()        // remove item tile portion\n    return false\n  }\n\n\n  // submits search results items to item manager for invoking operations on the list\n  static manage() {\n    // get list of all (remaining) identifiers in a search results page\n    const ids = $('.item-ia[data-id]').toArray().reduce((a, b) => {\n      const id = $(b).attr('data-id')\n      if (id === '__mobile_header__')\n        return a\n      return a.concat(id, ',')\n    }, '')\n    log('MANAGE', ids)\n\n    if (ids !== '') {\n      // now make a form that we can POST to, with all the identifiers,\n      // and post to /manage/ page\n      const $form = $(`\n        <form id=\"manage-ids\" method=\"POST\" action=\"/manage/\"\n              style=\"visibility:hidden;position:absolute;top:0;left:0;width:1px;height:1px;\">\n          <input type=\"text\" name=\"identifier\" value=\"${ids}\"/>\n        </form>`)\n      $('body').append($form) // NOTE: firefox needs it in DOM to submit\n      $form.submit()\n    }\n    return false\n  }\n\n\n  static head_img_dragdrop_setup(identifier) {\n    if (AJS.head_img_dragdrop_setup_done)\n      return\n    log('head_img_dragdrop_setup')\n    AJS.head_img_dragdrop_setup_done = true\n\n\n    $('#file-dropper-wrap').bind('mouseenter', () => {\n      log('enter')\n      AJS.head_img_replaceable(identifier)\n      $('#file-dropper').show()\n    }).bind('mouseleave', () => {\n      log('ouddie')\n      if (!AJS.file_picked)\n        $('#file-dropper').hide()\n    })\n\n    $('body').bind('dragover', (evt) => {\n      // enable file dropping\n      log('dragover')\n      evt.stopPropagation()\n      evt.preventDefault()\n\n      AJS.head_img_replaceable(identifier)\n      $('#file-dropper').addClass('drag_over').show()\n      return false\n    })\n\n    $('body').bind('dragleave', (evt) => {\n      log('dragleave')\n\n      // are we still over a file-dropper div/img?\n      let over = ($('#file-dropper-wrap').is(':hover') ||\n                  $('#file-dropper     ').is(':hover') ||\n                  $('#file-dropper-img ').is(':hover'))\n      const x = evt.pageX || evt.originalEvent.pageX\n      const y = evt.pageY || evt.originalEvent.pageY\n      if (!over) {\n        const e = $('#file-dropper-wrap')\n        const { left, top } = e.offset()\n        if (x >= left  &&  x <= left + e.outerWidth()  &&\n            y >= top   &&  y <= top  + e.outerHeight()) {\n          // still over the file drop target image area!\n          over = true\n        }\n      }\n      if (!over) {\n        const e = $('#file-dropper')\n        const { left, top } = e.offset()\n        if (x >= left  &&  x <= left + e.outerWidth()  &&\n            y >= top   &&  y <= top  + e.outerHeight()) {\n          // still over the file drop target image area!\n          over = true\n        }\n      }\n\n      if (!over)\n        $('#file-dropper').removeClass('drag_over').hide()\n    })\n  }\n\n  static head_img_replaceable(identifier) {\n    // helpfuls:\n    //  https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest\n    //  http://www.sitepoint.com/html5-ajax-file-upload/\n    if ($('#file-dropper').html().trim() !== '')\n      return\n\n    $('#file-dropper').show().html(`\n<div>\n<button id=\"file-cancel\" type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-hidden=\"true\"\n        title=\"cancel file upload\" alt=\"cancel file upload\">\n  &times;\n</button>\n<b>\n  <span style=\"font-size:40px; color:#aaa\" class=\"iconochive-plus-circle\" />\n</b><br/>\n<b>\n  Drag & Drop an image file here or\n</b>\n<button type=\"button\" class=\"btn btn-info btn-xs\" onclick=\"$('#file-selector').click();\">\n  Pick image to upload\n</button>\n<form method=\"POST\" action=\"/services/post-file.php?submit=1&identifier=${identifier}\"\n      enctype=\"multipart/form-data\" id=\"poster\">\n  <div class=\"hidden\">\n    <input id=\"file-selector\" name=\"file\" type=\"file\" accept=\"image/*\"/>\n  </div>\n  <input type=\"hidden\" name=\"identifier\" value=\"${identifier}\"/>\n  <input id=\"file-submit\" type=\"submit\" name=\"submit\" value=\"SUBMIT\" class=\"btn btn-success\"/>\n  <div id=\"file-uploading\">\n    Uploading your file..\n  </div>\n</form>\n</div>`)\n\n\n    $('#file-cancel').bind('click', (evt) => {\n      AJS.cancelFile()\n\n      evt.stopPropagation()\n      evt.preventDefault()\n      return false\n    })\n\n\n    $.event.props.push('dataTransfer') // if not set, dataTransfer is not sent\n\n\n    const success = () => {\n      log('success!')\n      // AJS.cancelFile()\n    }\n\n\n    // upload an image (typically a collection/list header or account/person profile)  via S3\n    // returns '' on success; else string w/ error/fail reason\n    const uploadFile = () => {\n      let fail = false\n\n      if (typeof XMLHttpRequest === 'undefined')\n        fail = 'browser appears to not have HTML5 functionality'\n\n      if (!fail)\n        fail = AJS.badFile()\n\n\n      const xhr = new XMLHttpRequest()\n      if (!fail) {\n        log(AJS.file2post)\n        if (!xhr.upload)\n          fail = 'browser submit setup failed'\n      }\n\n      if (fail)\n        return fail\n\n\n      // start upload\n      log('post')\n      // if (navigator.userAgent.indexOf('Safari') > 0) xhr.timeout = 10 * 60 * 1000; // 10 min\n      xhr.open(\n        'POST',\n        location.protocol.concat(\n          '//', location.host,\n          '/services/post-file.php?submit=1&identifier=', identifier,\n          '&fname=', encodeURIComponent(AJS.file2post.name),\n        ),\n        false,\n      ) // block synchronously on the post!\n      // if (!options.sendBoundary) xxx\n      xhr.setRequestHeader('Content-Type', 'multipart/form-data; charset=UTF-8')\n      xhr.send(AJS.file2post)\n\n      const reply = xhr.responseText\n      const mat = reply.match(/SUCCESS \\(task_id=(\\d+)\\)/)\n      if (mat  &&  mat.length) {\n        const task_id = mat[1]\n        log('STALKING TASK_ID: ', task_id)\n\n        $('#file-dropper').html('waiting for updates..')\n        let stalker_ptr = false\n        const stalker = () => {\n          log('STALKING...')\n          $.ajax({\n            type: 'GET',\n            url: '/catalog_status.php?where=task_id='.concat(task_id, '&rand=', Math.random()),\n            dataType: 'xml',\n            success: (xml) => {\n              log(xml)\n              const x = {\n                green: parseInt($(xml).find('wait_admin0').text(), 10) || 0,\n                blue:  parseInt($(xml).find('wait_admin1').text(), 10) || 0,\n                red:   parseInt($(xml).find('wait_admin2').text(), 10) || 0,\n              }\n              log(x)\n              const nWait = x.green + x.blue + x.red\n              $('#file-dropper').html(`waiting for ${nWait} tasks to run`)\n              if (!nWait) {\n                log('task(s) done!')\n                clearInterval(stalker_ptr)\n                $('#file-dropper').html('reloading page with your image')\n                location.href = location.href // ready! reload the page!\n              } else if (x.red) {\n                $('#file-dropper').html('<div class=\"alert alert-danger\">status task failure -- an admin will need to resolve</div>')\n                clearInterval(stalker_ptr)\n              }\n            },\n          })\n        }\n\n        // every 2 seconds, check for status\n        stalker_ptr = setInterval(stalker, 2000)\n      } else {\n        log(reply)\n      }\n\n      log('post done')\n      return ''\n    }\n\n\n    $('#file-selector').bind('click', () => {\n      AJS.file_picked = 'selected'\n    }).bind('change', (evt) => {\n      log('file dropdown selected!')\n      $('#file-submit, #file-cancel').show()\n      log(evt)\n      if (evt.target  &&  evt.target.files  &&  evt.target.files.length) {\n        [AJS.file2post] = evt.target.files\n        AJS.previewFile()\n      }\n    })\n\n\n    $('#file-dropper').bind('drop', (evt) => {\n      // we've been dropped a file (from a drag-and-drop)!\n      evt.stopPropagation()\n      evt.preventDefault()\n\n      log(evt.dataTransfer.files)\n      $('#file-dropper').removeClass('drag_over')\n\n      $('#file-submit, #file-cancel').show()\n\n\n      if (evt.dataTransfer.files.length) {\n        AJS.file_picked = 'dropped';\n        [AJS.file2post] = evt.dataTransfer.files\n        AJS.previewFile()\n      }\n    })\n\n\n    $('#poster').bind('focusin', (evt) => {\n      log(evt.type)\n      $('#file-uploading').show()\n    }).bind('submit', (evt) => {\n      log('submit!')\n      $('#file-uploading').show()\n\n      // First try the schmancy HTML5 submit via XMLHttpRequest and FileReader.\n      // If we fail, we'll fallback to form submit normal action.\n      const fail = uploadFile()\n      if (fail === '') {\n        // SUCCESS!  we are done!\n        success()\n        evt.stopPropagation()\n        evt.preventDefault()\n        return false\n      }\n\n      if (AJS.file_picked === 'dropped') {\n        // we had client drag-n-drop the file -- we can't post it!\n        // epic fail...\n        AJS.cancelFile()\n        // eslint-disable-next-line  no-alert\n        alert(`Failure: ${fail}`)\n        evt.stopPropagation()\n        evt.preventDefault()\n        return false\n      }\n\n      // OK fallback to normal (selected) file submit (and full page reload)!\n      return true\n    })\n\n\n    // now center file-dropper over current image\n    const w1 = $('#file-dropper-img').outerWidth()\n    const h1 = $('#file-dropper-img').outerHeight()\n    const w2 = $('#file-dropper').outerWidth()\n    const h2 = $('#file-dropper').outerHeight()\n    $('#file-dropper').css({\n      left: Math.round((w1 - w2) / 2),\n      top:  Math.round((h1 - h2) / 2),\n    })\n\n    if (AJS.ios) {\n      $('#file-dropper > form > div.hidden').removeClass('hidden')\n      $('#file-dropper > button').addClass('hidden')\n    }\n  }\n\n\n  // client-side preview the image directly in the browser!  xxx catch exceptions, etc.\n  static previewFile() {\n    $('#file-dropper .uppreview').remove() // remove any prior upload/preview\n\n    if (AJS.badFile()) {\n      AJS.cancelFile()\n      return false\n    }\n\n    if (typeof FileReader === 'undefined')\n      return false\n\n    const reader = new FileReader()\n    reader.onload = (evt) => {\n      log(evt.target)\n      const im = new Image()\n      im.src = evt.target.result\n      $('#file-dropper').append(im)\n      $(im).addClass('uppreview')\n      // $('#file-dropper').css(\n      //      {'background':'url(' + evt.target.result + ') no-repeat center center'})\n    }\n\n    log(AJS.file2post)\n    reader.readAsDataURL(AJS.file2post)\n    return true\n  }\n\n\n  static cancelFile() {\n    $('#file-dropper .uppreview').remove() // remove any prior upload/preview\n    $('#file-dropper, file-submit, #file-cancel, #file-uploading').hide()\n    if (AJS.file_picked)\n      delete AJS.file_picked\n    if (AJS.file2post)\n      delete AJS.file2post\n  }\n\n\n  static badFile() {\n    let fail = false\n\n    if (!fail  &&  !AJS.file2post)\n      fail = 'file is missing'\n\n    // php upload_max_filesize is 8M\n    if (!fail  &&  AJS.file2post.size > 8000000)\n      fail = 'file is over 8MB in size'\n\n    if (!fail) {\n      const type = AJS.file2post.type.toLowerCase()\n      if (type !== 'image/jpeg' && type !== 'image/png' && type !== 'image/gif')\n        fail = 'file not required format of JPEG or PNG or GIF'\n    }\n\n    if (fail)\n      // eslint-disable-next-line  no-alert\n      alert(fail)\n\n    return fail\n  }\n\n\n  // for microfilm books with many months of newspapers in PDF\n  //   eg: /details/la_caleagle_reel1\n  //\n  // paginfo is a logical hashmap JSON object of:\n  //   YYYYMMDD => [comma separated list of pages]\n  // eg:\n  //   20080129 =>  \"1,2,3,11,17\"\n  static drawPDF(identifier, pageinfo) {\n    const urlstart = '/download/'.concat(\n      identifier, '/',\n      identifier, '_pdf.zip/',\n      identifier, '_pdf/', identifier, '_',\n    )\n    let multi_year = false\n    let last_year  = false\n\n    // eslint-disable-next-line  guard-for-in\n    for (const key in pageinfo) {\n      const year = key.substr(0, 4)\n      if (last_year === false) last_year = year\n      if (last_year !== year) {\n        multi_year = true\n        break\n      }\n    }\n\n    const sep = ''\n    let str = sep\n    let lastyearmonth = 666\n    // eslint-disable-next-line  guard-for-in\n    for (const key in pageinfo) {\n      // log(key); log(pageinfo[key]);\n      const pages     = pageinfo[key].split(',')\n      const year      = key.substr(0, 4)\n      const month     = parseInt(key.substr(4, 2), 10)\n      const day       = parseInt(key.substr(6, 2), 10)\n      const yearmonth = year.concat('-', month)\n      let skip_day = false\n\n      let monthName = ''\n      if (yearmonth !== lastyearmonth) {\n        /**/ if (month ===  1)        monthName = 'January'\n        else if (month ===  2)        monthName = 'February'\n        else if (month ===  3)        monthName = 'March'\n        else if (month ===  4)        monthName = 'April'\n        else if (month ===  5)        monthName = 'May'\n        else if (month ===  6)        monthName = 'June'\n        else if (month ===  7)        monthName = 'July'\n        else if (month ===  8)        monthName = 'August'\n        else if (month ===  9)        monthName = 'September'\n        else if (month === 10)        monthName = 'October'\n        else if (month === 11)        monthName = 'November'\n        else if (month === 12)        monthName = 'December'\n        else if (month === undefined) monthName = 'Single Page PDFs'\n        else /*             */        monthName = 'Unknown_'.concat(month)\n\n        if (multi_year) monthName = year.concat(' ', monthName)\n\n        // make header/a that shows/hides a hidden div after it with the month's data\n        str += (str ? '</div><!--mo--><br/>' : '')\n        str += `\n<a href=\"#${monthName},${year}\" onclick=\"$('#m${yearmonth}').toggle(); return false\">\n<span class=\"iconochive-folder\" /> ${monthName}\n</a>\n<div class=\"mo\" id=\"m${yearmonth}\">`\n      }\n\n      // make header/a that shows/hides a hidden div after it with the page data\n      if ((day === undefined) || (day === '')) skip_day = true\n      if (skip_day) {\n        str += '<div class=\"day\">'\n      } else {\n        str += `\n<div class=\"day\">\n<a href=\"#${yearmonth}-${day}\"\n    onclick=\"$('#m${yearmonth}d${day}').toggle();return false;\">\n  <span class=\"iconochive-folder\" /> ${day}\n</a>\n<div class=\"pages\" id=\"m${yearmonth}d${day}\">`\n      }\n\n      // drop in the individual page links\n      let offset = 1\n      let page\n      let pnum\n      for (let j = 0; j < pages.length; j++) {\n        page = pages[j]\n        if (!page)\n          // eslint-disable-next-line  no-continue\n          continue\n        if (offset > 0) offset = 1 - page\n        pnum = parseInt(page, 10) + offset\n\n        // left 0-pad to 4 digits as needed\n        page = '0000'.concat(page)\n        page = page.substr(page.length - 4, 4)\n\n        const url = urlstart.concat(page, '.pdf')\n        str += `<a href=\"${url}\">[${pnum}]</a> `\n      }\n\n      if (skip_day)\n        str += '</div>'\n      else\n        str += '</div><!--pages--></div><!--day-->'\n\n      lastyearmonth = yearmonth\n    }\n\n    str += '</div><!--mo-->'\n\n    // replace the \"pdfs\" empty div with our hefty HTML\n    $('#pdfs .replaced').html(str)\n  }\n\n\n  // for collection pages, [About] tab\n  static grafs() {\n    const $grafs1 = $('#grafs1')\n    const $grafs2 = $('#grafs2')\n    if (!$grafs1.length)\n      return\n    if (typeof $grafs1.attr('data-id') === 'undefined')\n      return\n\n    const identifier = $grafs1.attr('data-id')\n    $grafs1.attr('data-id', null)\n\n    log('loading grafs')\n    $grafs1.html('<i><small>loading graph <img src=\"/images/loading.gif\"/></small></i>').show()\n    $grafs2.html('<i><small>loading graph <img src=\"/images/loading.gif\"/></small></i>').show()\n    const tok = '<h2>'\n    $.get('/details/'.concat(identifier, '&grafs=1&v=3'), (htm) => {\n      const a = htm.split(tok)\n      if (a.length >= 3) {\n        $('#activity-reviewsN').html(a[1]).parents('.activity-box').show()\n        $('#activity-forumN  ').html(a[2]).parents('.activity-box').show()\n      }\n      if (a.length === 5) {\n        $grafs1.html(tok + a[3])\n        $grafs2.html(tok + a[4])\n      } else {\n        $grafs1.html('(graph data not available)')\n        $grafs2.html('(graph data not available)')\n      }\n    })\n\n    AJS.setUpTopRegionsTable()\n  }\n\n\n  static quick_down(id, target) {\n    const idsel = `#${id}`\n\n    if (!$('.format-group.in').length) {\n      // no set of files for a single format showing... yet!\n      const format = $(target).text()\n      const $formatGroup = $(idsel).parents('.format-group')\n\n      $('.download-button').html(format.concat(' FILES'))\n      $formatGroup.addClass('in')\n      // hide the other summary formats (one-liner) clickables\n      $('.format-group:not(.in)').slideUp()\n      $(idsel).slideDown()\n    } else {\n      // re-open all the summary formats (one-liner) clickables\n      $('.format-group').slideDown(400)\n      // close the open set of single files\n      setTimeout(() => { // ftw, thx for nothing jquery\n        $('.format-group.in').removeClass('in')\n        $('.download-button').html('DOWNLOAD OPTIONS')\n      }, 400)\n      $(idsel).slideUp()\n    }\n\n    return false\n  }\n\n\n  // parse a CGI arg\n  static arg(theArgName, try_full) {\n    const sArgs = (try_full  &&  location.search === '' ?\n      location.href.slice(1).split('&') :\n      location.search.slice(1).split('&'))\n    for (let i = 0; i < sArgs.length; i++) {\n      if (sArgs[i].slice(0, sArgs[i].indexOf('=')) === theArgName) {\n        const r = sArgs[i].slice(sArgs[i].indexOf('=') + 1)\n        return (r.length > 0 ? unescape(r).split(',') : '')\n      }\n    }\n    return ''\n  }\n\n  // setup trigger on 1/2 second of hovering over the nav IA logo\n  static logoText() {\n    const hideLogoText = () => {\n      $('#internet-archive').fadeOut('slow', () => {\n        $('#internet-archive').remove()\n        $('#exit-er').show()\n      })\n    }\n\n    let mousetimer = false\n\n    // axxx make sure when it opens on TAB, the about li is in the DOM *next*\n    $('.navbar-nav:first').on('mouseenter focusin', (evt) => {\n      // Only proceed if user is interacting with the logo elements.\n      if (!$(evt.target).is('ul, .navbar-brand, .iconochive-logo, .logo-text-hider'))\n        return\n\n      mousetimer = setTimeout(() => {\n        if ($('#internet-archive').length) {\n          hideLogoText()\n          return\n        }\n\n        $('#exit-er').hide() // (gets in the way of xs/mobile!)\n        // flank the IA logo!\n        $('.navbar-nav:first').prepend($(`\n<div id=\"internet-archive\" class=\"hidden-xs logo-text-hider\"\n  style=\"position:absolute; top:10px; width:100%; text-align:center;\">\n<div class=\"topinblock logo-text-hider\" style=\"width:100px; padding-left:10px;\">\n  <div class=\"logo-text-hider\"\n      style=\"display:none; width:85px; height:30px; background:transparent -35px top no-repeat url(/images/footer.png)\" />\n</div><div class=\"topinblock logo-text-hider\" style=\"width:35px;height:1px;\" /><div class=\"topinblock logo-text-hider\" style=\"width:100px;\">\n  <div class=\"logo-text-hider\" style=\"display:none; width:85px; height:30px; background:transparent -116px top no-repeat url(/images/footer.png)\" />\n</div>\n</div>`))\n\n        // both of the above divs are hidden.  now fade them in\n        $('#internet-archive > div > div').fadeIn('slow')\n      }, 1000)\n    }).mouseleave(() => {\n      if (mousetimer) clearTimeout(mousetimer)\n    })\n  }\n\n  static scrolled() {\n    const newtop = $(window).scrollTop()\n    // log('scrolled to ', newtop)\n\n    const selector = '.more_search:visible'\n    const $e = $(selector)\n    if (!$e.length)\n      return\n\n    // make the edge detect for \"hit bottom\" 40 pixels from the bottom\n    const check = (($e.offset().top + $e.outerHeight()) - $(window).height()) - 40\n    // log('-v- check', check)\n    if (newtop > check) {\n      log('hit rock bottom > ', check)\n      if (!AJS.more_searching)\n        $(selector.concat(' > a')).click()\n    }\n  }\n\n\n  static more_search(lnk, urlIn, page_now) {\n    const selector = AJS.selector()\n    if (selector === false)\n      return false\n\n    const ikind = selector.replace(/#ikind-/, '')\n\n    const $more_search = $(selector.concat(' .more_search'))\n\n    // we stash a reference of what page the client has requested, so we can increment it on\n    // each \"more_search hit\n    const pageKey = selector\n    if (typeof AJS.page_map[pageKey] === 'undefined')\n      AJS.page_map[pageKey] = (page_now || 1)\n\n    if (AJS.page_map[pageKey] < 0) {\n      // $more_search.find('.more-search-all').show()\n      return false // all results showing -- no more for the ikind avail so noop/ignore\n    }\n\n    AJS.page_map[pageKey] += 1\n    const page = AJS.page_map[pageKey]\n\n    $more_search.find('.more-search-fetching').show()\n\n    AJS.more_searching = true\n\n    let url = urlIn + page\n    const urlreplace = location.protocol.concat('//', location.host, url)\n    url += '&scroll=1'\n\n    log('url: ', url)              // url to AJAX get next page\n    log('urlreplace', urlreplace)  // url to change browser location (visually) to\n\n\n    log('more_search(selector=', selector, 'sort=', ikind, 'page=', page, 'url=', url, ')')\n    // log(AJS.page_map)\n\n\n    $.get(url, (htm) => {\n      if (htm.length < 100  &&  $(htm).find('div.no-results')) {\n        // no more results avail/found.  we have reached infinity!\n        $more_search.find('.more-search-fetching, a.btn').hide()\n        // $more_search.find('.more-search-all').show()\n        AJS.page_map[pageKey] = -1 // flag to ignore future more_search attempts\n        AJS.more_searching = false\n        return\n      }\n\n      if (AJS.pushState  &&  typeof history.replaceState !== 'undefined')\n        history.replaceState({}, '', urlreplace)\n\n\n      const selectorID = $(selector).attr('id')\n      if (AJS.tilerPREV  &&  AJS.tilerPREV.unsourced  &&  AJS.tilerPREV.unsourced[selectorID])\n        delete AJS.tilerPREV.unsourced[selectorID]\n\n\n      const $selector = $(selector.concat(' .results'))\n      $selector.append(AJS.addNotes(AJS.addingNotesKind, htm))\n\n      // re-tile and re-flow!  (the force should flow through you)\n      AJS.tiler(selector)\n      $more_search.find('.more-search-fetching').hide()\n      AJS.more_searching = false\n\n      AJS.parent_hover($selector)\n\n\n      // OK, this is quite a bit more subtle...  the HTM has been dropped in,\n      // *and* we've done a basic re-tiling.  however, it's very likely many\n      // of the images are still loading.  so listen for image \"is loaded\" events\n      // if they trickle in, and at most re-tile every 1 second (even if they\n      // likely trickling in at a faster rate than that) until they all loaded\n      $(selector.concat(' img')).on('load', () => {\n        clearTimeout(AJS.more_search_throttler)\n        AJS.more_search_throttler = setTimeout(AJS.tiler, 1000)\n      })\n\n\n      if (typeof archive_analytics !== 'undefined')\n        archive_analytics.send_scroll_fetch_event(page)\n    })\n\n    return false\n  }\n\n\n  // when embed codes are being shown, adjust their heights so they show all the content/codes!\n  static embed_codes_adjust() {\n    log('showing embeds!')\n\n    // these are found (only) on /details/ pages\n    for (const embid of ['embedcodehere', 'embedcodehereWP']) {\n      const $embid = $(`#${embid}`)\n      $embid.removeAttr('rows').css('height', '')\n\n      const embtxt = $embid.text()\n\n      // this is *puke* city -- since textareas are a PITA, make a shadow div w/ the\n      // text we want in it, trying to be same width, same font-size, etc.\n      // and *then* insert into DOM invisibily so we can calculate its overall height\n      // .. and then peg the textarea height to that height\n      $('body').prepend($('<div/>').attr({\n        id: `${embid}Shadow`,\n        class: 'textarea-invert-readonly roundbox5',\n      }).css({\n        position: 'absolute',\n        visibility: 'hidden',\n        top: 60,\n        left: 10,\n        padding: '5px 15px 5px 15px',\n        width: $embid.width(),\n        'font-size': $embid.css('font-size'),\n      })\n        .text(embtxt))\n\n      const bestHT = $(`#${embid}Shadow`).outerHeight() + 15\n      log(embid, 'bestie height', bestHT, 'for current width', $embid.width())\n      $(`#${embid}Shadow`).remove()\n\n      $embid.height(bestHT)\n    }\n  }\n\n\n  /**\n   * A simpler 'one shot' way to dynamically insert a modal and show it on the page.\n   * You can call it w/ a hashmap of optional paramters to make it very easy on caller end to grok\n   * (similar to python's kwargs)\n   *\n   * @param  {String} [prepend='body']        a jQuery selector where to prepend the modal markup\n   * @param  {String} [selector='#my-modal']  a unique id -- is _first_ remove(d), and then added\n   * @param  {String} [title='confirmed']     what title/header should appear\n   * @param  {String} [body='']               text/markup for the modal body\n   * @return n/a\n   */\n  static modal({\n    prepend = 'body',\n    selector = '#my-modal',\n    title = 'confirmed',\n    body = '',\n  } = {}) {\n    const id = selector.replace(/#/, '')\n    $(selector).remove()\n    $(prepend).prepend(`\n<div id=\"${id}\" class=\"modal fade\" role=\"dialog\" aria-hidden=\"true\">\n<div class=\"modal-dialog modal-lg\">\n  <div class=\"modal-content\" style=\"padding:10px;\">\n    <div class=\"modal-header\">\n      <button\n        type=\"button\"\n        class=\"close\"\n        data-dismiss=\"modal\"\n        aria-hidden=\"true\">\n        <span class=\"iconochive-remove-circle\" aria-hidden=\"true\"></span><span class=\"sr-only\">remove-circle</span></button>\n      <h3 class=\"modal-title\">${title}</h3>\n    </div>\n    <div id=\"${id}-body\">${body}</div>\n  </div>\n</div>\n</div>`)\n    $(selector).modal('show')\n  }\n\n\n  // dynamically adds modal to page (if isnt there already)\n  static _modal_add(selector, conf) { // logically private\n    log(conf)\n\n    if ($(selector).length)\n      return\n\n    const selectorID = selector.replace(/#/, '')\n\n    $('body').prepend(`\n<div id=\"${selectorID}\" class=\"modal fade\" role=\"dialog\" aria-hidden=\"true\">\n<div class=\"modal-dialog modal-lg\">\n  <div class=\"modal-content\">\n    <div class=\"modal-header ${conf.headerClass ? conf.headerClass : 'modal-header-std'}\">\n      <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">\n        <span class=\"iconochive-remove-circle\"></span>\n      </button>\n      <h2 class=\"modal-title\">\n        ${typeof conf.title === 'undefined' ? 'Confirmed' : conf.title}\n      </h2>\n    </div>\n    <div id=\"${selectorID}-body\">\n      ${typeof conf.body === 'undefined' ? '' : conf.body}\n    </div>\n  </div>\n</div>\n</div>`)\n\n    // $('body').addClass('blurry') // exxxperiment!\n  }\n\n\n  static modal_beta(lnk, confIn) { // NOTE: not in use now\n    const conf = confIn\n    conf.title = '<center>Give Us Feedback!</center>'\n\n    // Set a cookie *NOW* w/ JS -- so we can absolutely assure that if user hits\n    // the exit form *WITHOUT* cookies, that they must be disabling cookies on archive.org\n    // (but interestingly have JS enabled (since they are here! ;-))\n    // So exit form can give them \"you need to enable cookies\" fail...\n    $.cookie('beta-modal', 'open', { path: '/', expires: 1, domain: '.archive.org' })\n\n    const selector = $(lnk).attr('data-target')\n    conf.href = location.href\n    conf.href = conf.href.replace(/&ui3=1$/, '')\n    conf.href = conf.href.replace(/\\/v2$/,  '')\n\n    conf.body = `\n<style> #fback h4 { margin-top:30px; } </style>\n<div id=\"fback\" style=\"padding:20px\">\n  <a target=\"_blank\" href=\"/details/v2tour20150420\">\n    <div style=\"text-align:center; float:right\">\n      <img src=\"/download/v2tour20150420/v2tour20150420.thumbs/April202015Tour_000375.jpg\"/><br/>\n      TUTORIAL VIDEO\n    </div>\n  </a>\n  <div style=\"font-size:18px\">\n    Please take a moment to give us feedback below.\n    We consider these comments as we make changes to the site.\n  </div>\n  <h5 style=\"display:none\">\n    <br/><br/><br/>\n    THANK YOU for your valuable feedback!\n  </h5>\n  <form id=\"modal_beta_form\" method=\"POST\" action=\"/services/exit.php\">\n    <input type=\"hidden\" name=\"feedback_only\" value=\"1\"/><br/>\n\n    <h4>Feedback (details are helpful):</h4>\n    <textarea class=\"form-control input-sm\" name=\"feedback\" rows=\"4\"></textarea>\n\n    <h4>May we contact you about your feedback?</h4>\n    <input type=\"radio\" name=\"contact\" value=\"yes\"/> yes, here's my email address:<br/>\n    <input class=\"form-control input-sm\" type=\"text\" name=\"eml\"/> <br/>\n    <input type=\"radio\" name=\"contact\" value=\"no\"/> no<br/>\n    <hr style=\"border-color:black;background-color:black;color:black\" />\n    You can use the classic version of archive.org for a limited period of time.<br/>\n    <a target=\"_blank\" href=\"https://blog.archive.org/2014/11/05/redesign/\">\n      Learn more\n    </a>\n    about why archive.org changed.<br/>`\n\n    if (conf.feedback_only) {\n      conf.body += `\n        <input class=\"btn btn-primary\" type=\"submit\" style=\"margin-top:20px\" value=\"Submit\"/>`\n    } else {\n      conf.body += `\n        <input class=\"btn btn-primary\" type=\"submit\" style=\"margin-top:20px\" value=\"Submit Feedback\"/>\n        <input id=\"modal_beta_form_exit\" class=\"btn\" type=\"button\" style=\"margin-top:20px\" value=\"Exit to Classic Site\"/>`\n    }\n    conf.body += `\n    <br/><br/>\n    <i>What's New?</i>\n    [\n      <a target=\"top\" href=\"https://blog.archive.org/2015/02/12/whats-new-with-v2/\">recent changes</a> |\n      <a target=\"top\" href=\"/CHANGELOG.txt\">detailed CHANGELOG</a>\n    ]\n  </form>\n</div>`\n\n\n    AJS._modal_add(selector, conf)\n\n    // in case it's not obvious, there are FOUR CASES we (have to) handle:\n    //   feedback only, hit [submit] button\n    //   feedback only, cancel out (no feedback given)\n    //   exit beta, hit [submit] button\n    //   exit beta, no feedback given\n    $('#modal_beta_form_exit').on('click', () => {\n      $('#modal_beta_form input[name=feedback_only]').val(0)\n      conf.feedback_only = false\n      conf.exiting = true\n      $('#modal_beta_form').submit()\n    })\n\n\n    $('#modal_beta_form').on('submit', () => {\n      log('submit clicked!')\n\n      conf.submitted = true\n      conf.postdata = $('#modal_beta_form').serialize() // oh, fkya!\n\n      // we're polite\n      $(selector.concat(' h5')).fadeIn('slow')\n      $(selector.concat(' form')).fadeOut('slow')\n\n\n      setTimeout(() => {\n        // AJAX form post, keeping page where it is\n        $.post('/services/exit.php', conf.postdata, () => {\n          log('POSTED ', conf.postdata)\n\n          if ((!conf.feedback_only  ||  conf.exiting)  &&  document.cookie === '') {\n            // user disables cookies, so go directly to exit form where we'll\n            // give them more information about that and how we can't \"stick\"\n            // their preference to exit beta...\n            log('EXITING BUT HAS NO COOKIES!')\n            location.href = '/services/exit.php'\n            return\n          }\n\n          $('body').removeClass('blurry')\n          $(selector).modal('hide')\n        })\n      }, 2500)\n\n      return false // dont do *normal* submit of the form (and drive the page away)\n    })\n\n\n    $(selector).modal('show').on('hidden.bs.modal', () => {\n      log('beta modal hidden')\n\n      $('body').removeClass('blurry')\n      if (conf.feedback_only  ||  !conf.exiting) {\n        $(selector).remove()\n        return\n      }\n\n      const exitFN = () => {\n        if (!conf.submitted) {\n          // user clicked out of modal or [x] close button -- no form submit\n          // but they DO want to exit beta...\n          location.href = '/services/exit.php'\n        } else {\n          $(selector).remove()\n          log('going to ', conf.href)\n          location.href = conf.href\n        }\n      }\n\n\n      if (typeof archive_analytics !== 'undefined') {\n        archive_analytics.send_ping({\n          kind: 'event',\n          ec: 'in_beta',\n          ea: 'exit',\n          cache_bust: Math.random(),\n        }, exitFN) // once analytics GIF is loaded, invoke our callback!\n      } else {\n        log('uho analytics not defined!')\n        // should never happen, but just to be safe!!\n        exitFN()\n      }\n    })\n    return false\n  }\n\n\n  /**\n   * Parse API data and check if the item is successfully marked to favorite or not\n   *\n   * @param {String} bookmarkRes response data from /bookmarks.php?add_bookmark=1&...\n   * @return {Boolean}\n   */\n  static isFavoriteSuccessful(bookmarkRes) {\n    return (bookmarkRes.indexOf('<meta name=\"ia-favorite-success\" content=\"1\">') !== -1)\n  }\n\n  // gives us ability to have JS intercept an href click and instead do a bootstrap modal.\n  // eg: when someone Favorites a list or item - a kind of confirmation box.\n  //     In that case, we want it to just say Favorited with a big black star in the middle.\n  //     We don't take user to the href target.\n  //     The modal disappears if the user clicks anywhere and returns to page they were on.\n  //     Timeout of a few seconds to close modal if they do nothing.\n  // config is a hashmap with optional keys:\n  //   auto_close, auto_remove, body, center, favorite, ignore_lnk, titlen,\n  //   headerClass, shown, follow_link_on_dismiss\n  static modal_go(lnk, confIn) {\n    const conf = confIn // sigh\n\n    if (conf.favorite) {\n      // this flicks on a bunch of config options\n      conf.center = true\n      conf.auto_close = true\n      conf.title = 'Favorited'\n      conf.body = '<center><span style=\"font-size:100px;\" class=\"iconochive-favorite\"></span></center>'\n      conf.login = true // must be logged in!\n    }\n\n    const selector = $(lnk).attr('data-target')\n    const href     = $(lnk).attr('href')\n\n    AJS._modal_add(selector, conf)\n\n\n    if (conf.shown) {\n      $(selector).on('shown.bs.modal', () => {\n        conf.shown()\n      })\n    }\n\n    if (conf.follow_link_on_dismiss) {\n      $(selector).on('hidden.bs.modal', () => {\n        log('modal hidden, going to ', href, '..')\n        $('body').removeClass('blurry')\n        location.href = href\n      })\n    }\n\n\n    $(selector).modal('show')\n\n\n    if (conf.login  &&  $.cookie('logged-in-user') === null) {\n      if (location.protocol !== 'https:') {\n        // make absolutely sure we never login with http!\n        location.href = 'https://archive.org/account/login.php'\n        return false\n      }\n      const url = '/account/login.php'\n      $.get(url, (htmIn) => {\n        $(selector.concat(' .modal-title')).text('Nearly there!  Please login first')\n\n        $(selector).modal('show')\n        // this allows us to effectively rip off the header/nav and footer\n        // if we are accessing a full page (eg: account login page)\n        const htm = ($(htmIn).find('.container-ia > div').length ?\n          $(htmIn).find('.container-ia > div').get(0) :\n          htmIn\n        )\n\n        $(selector.concat('-body')).html(htm)\n\n        const $form = $(selector.concat('-body form:has(input[type=submit])'))\n\n        if ($form.length) {\n          $form.on('submit', (evt) => {\n            evt.preventDefault()\n            evt.stopPropagation()\n\n            const keyvals = {}\n            $form.find('input').each((k, v) => {\n              if ($(v).attr('name').length)\n                keyvals[$(v).attr('name')] = $(v).val()\n            })\n            // log('POST', url)\n            // log(keyvals)\n            $.post(url, keyvals, () => {\n              log('SUBMITTED')\n              if ($.cookie('logged-in-user') !== null) {\n                // SUCCESS!\n                // We are going to hide the login modal now, and need\n                // to proceed only *after* the modal animation is done\n                // and modal is gone.  So setup listener now, *then* hide.\n                // Once login modal is gone, remove the modal, and\n                // invoke the originally intended modal in fresh environment!\n                $(selector).on('hidden.bs.modal', () => {\n                  $(selector).remove()\n                  log('SUCCESS')\n                  AJS.modal_go(lnk, conf) // invoke original modal!\n                })\n                $('body').removeClass('blurry')\n                $(selector).modal('hide')\n              } else {\n                // eslint-disable-next-line  no-alert\n                alert('Please try logging in again')\n              }\n            })\n\n            return false\n          })\n        }\n      })\n      return false\n    }\n\n\n    if (conf.auto_remove) {\n      conf.auto_close = true\n      $(selector).on('hidden.bs.modal', () => {\n        $(selector).remove()\n        $('body').removeClass('blurry')\n      })\n    }\n\n\n    if (!conf.ignore_lnk) {\n      const url = lnk.href\n      // log('submit', url)\n      $.get(url, (res) => {\n        if (conf.favorite) {\n          if (typeof archive_analytics !== 'undefined') {\n            archive_analytics.send_ping({\n              kind: 'event',\n              ec: 'page_action',\n              ea: 'favorite',\n              el: location.pathname,\n              cache_bust: Math.random(),\n            })\n          }\n\n          if (AJS.isFavoriteSuccessful(res)) {\n            $('#favorite-button').addClass('favorited')\n          } else {\n            const $favModal = $(selector)\n            const failMessage = `\n              <center>\n                <p class=\"favorite-failure-message\">\n                  There was an error adding the favorite. If the problem persists, please contact support.\n                </p>\n              </center>\n            `\n\n            $favModal.find('.modal-title').html('Failed')\n            $favModal.find('#confirm-modal-body').html(failMessage)\n          }\n        }\n\n        $(selector).modal('show')\n        if (conf.auto_close)\n          setTimeout((() => $(selector).modal('hide')), 2000)\n      })\n    } else {\n      $(selector).modal('show')\n    }\n\n    if (conf.center)\n      $(selector.concat(' .modal-dialog')).center() // vertically center\n\n    if (conf.auto_close  &&  conf.ignore_lnk)\n      setTimeout(() => $(selector).modal('hide'), 2000)\n\n    return false\n  }\n\n\n  // handy little method to ensure only 1 checkbox is checked\n  static check1(obj, selector) {\n    if (!obj.checked)\n      return\n\n    // toggle others to unchecked\n    const $selector = (selector ? $(selector) : $(obj).parents('form'))\n\n    // uncheck all; the re-check the checked one\n    $selector.find('input[type=checkbox]').attr('checked', false)\n\n    // eslint-disable-next-line  no-param-reassign\n    obj.checked = true\n  }\n\n\n  static addCommas(nStr) {\n    // http://www.mredkj.com/javascript/numberFormat.html\n    const x = (`${nStr}`).split('.')\n    let x1 = x[0]\n    const x2 = x.length > 1 ? '.'.concat(x[1]) : ''\n    const rgx = /(\\d+)(\\d{3})/\n    while (rgx.test(x1))\n      x1 = x1.replace(rgx, '$1,$2')\n    return x1 + x2\n  }\n\n\n  static suffixFmt(val, axis) {\n    if (axis.min >= 0.0  &&  axis.max <= 5)\n      // give a little bit more granularity of 1 decimal point...\n      return Math.round(val * 10, 1) / 10\n\n    if (val >= 1000000) return (val / 1000000).toFixed(0).concat(' M')\n    if (val >=    1000) return (val /    1000).toFixed(0).concat(' K')\n    return val.toFixed(0)\n  }\n\n\n  static suffixFmtPercent(val, axis) {\n    return AJS.suffixFmt(val, axis).concat('%')\n  }\n\n\n  static descript() {\n    const d = $('#descript').get(0)\n    if (d  &&  d.offsetHeight < d.scrollHeight) {\n      // we overflowed the short descript at the top of the collection page.\n      // so show the little MORE button..\n      $('#descript-more').show()\n      // $('#descript').css({'border-bottom':'1px solid #ccc'})\n    }\n  }\n\n\n  // this allows easy setup for resize/orientation triggers for all graphs\n  // on a page that use this!\n  static plotter(callback) {\n    if (typeof AJS.plotters === 'undefined')\n      AJS.plotters = []\n\n    if (callback) {\n      // stash a copy of the callback for resize/orientationchange triggers\n      AJS.plotters.push(callback)\n\n      // now do the actual plotting (eg: page load)\n      callback()\n    } else {\n      // step through each graph and rerun them\n      log('plotter() resize/orient change', AJS.plotters.length, 'graphs to resize')\n      for (let i = 0; i < AJS.plotters.length; i++)\n        AJS.plotters[i]()\n    }\n  }\n\n\n  // Graphing for archive.org/services/views.php and TV\n  static plot(id, cfgIn, fmt_fn, pts, many) {\n    const cfg = cfgIn\n    if (!cfg.xaxis)\n      cfg.xaxis = { mode: 'time', color: (cfg.dark ? '#ccc' : '#545454') }\n    if (!cfg.yaxis)\n      cfg.yaxis = { color: (cfg.dark ? '#ccc' : '#545454') }\n\n    let barWidth\n    if (many && cfg.barWidth)\n      barWidth = cfg.barWidth * 1 // *1 to pass lint; keeps like below; avoid obj destructuring\n    else if (cfg.barWidth)\n      barWidth = cfg.barWidth * 86400 * 1000\n    else\n      barWidth = (cfg.dayBarsNoPoints ? 1 : 7) * 86400 * 1000 // 1day|1week\n\n    cfg.series = {\n      bars: {\n        show: true,\n        barWidth,\n        fill: 0.6,\n        color: '#385C74',\n      },\n      color: '#385C74',\n      points: { show: !cfg.dayBarsNoPoints },\n    }\n\n    if (typeof cfg.grid === 'undefined') {\n      cfg.grid = {\n        borderColor: (cfg.dark ? '#333' : '#aaa'),\n        hoverable: true,\n      }\n    }\n    // log(cfg.series.bars)\n\n\n    if (cfg.dark)\n      cfg.grid.backgroundColor = '#002b36'\n\n    if (!cfg.tip)\n      cfg.tip = {}\n    if (!cfg.tip.id)\n      cfg.tip.id = id\n\n    if (typeof window.GraphPriorIndex === 'undefined')\n      window.GraphPriorIndex = {}\n\n    // eslint-disable-next-line  no-nested-ternary\n    const ary = (many ? pts : (typeof pts.data === 'undefined' ? [{ data: pts }] : [pts]))\n    if (cfg.dayBarsNoPoints  &&  !cfg.noLabel)\n      ary[0].label = id\n\n    const selid = `#${id}`\n    $.plot($(selid), ary, cfg)\n\n    if (!fmt_fn)\n      return\n\n    $(selid).bind('plothover', (event, pos, item) => {\n      if (!item) {\n        window.GraphPriorIndex[id] = -666\n        $('#gtip').remove()\n        return\n      }\n      if (window.GraphPriorIndex[id] !== item.dataIndex) {\n        window.GraphPriorIndex[id] = item.dataIndex\n        $('#gtip').remove()\n\n        const str = fmt_fn(item.datapoint[0], item.datapoint[1])\n        const $graf = $(selid)\n        const off = $graf.offset()\n\n        // figure out which way from the \"dot\"/bar in the graph the\n        // tooltip should go -- left or right!\n        let { pegTo } = cfg.tip\n        if (!pegTo)\n          pegTo = ((pos.pageX - off.left) > ($graf.width() / 2) ? 'right' : 'left')\n\n        const pegToVal = (pegTo === 'right' ?\n          ($graf.width() - (pos.pageX - off.left - 20)) :\n          (pos.pageX - off.left) + 20)\n        log(pegTo, pegToVal)\n\n        $(`#${cfg.tip.id}`).append(`\n<div id=\"gtip\" class=\"roundbox2\"\nstyle=\"top:${pos.pageY - off.top}px; ${pegTo}:${pegToVal}px\">${str}</div>`)\n      }\n    })\n  }\n\n\n  // Use a color sampling 3rd party piece of code, to find the 1st/primary image in the \"welcome\"\n  // area, and find the \"dominant color\".  (internally, uses canvas to color sample).\n  // Adjust text/foreground color as well as any \"selected tab\" background color.\n  // NOT USED ANYMORE -- GONE SERVERSIDE!\n  static welcome_recolor(e) {\n    if (typeof ColorThief === 'undefined'  ||  !e.length)\n      return\n\n    if (AJS.welcome_recolored)\n      return\n    AJS.welcome_recolored = true\n\n    const img = $(e)[0]\n    log('welcome_recolor', img.src)\n\n    /* global ColorThief */\n    const ct = new ColorThief()\n    const palette = ct.getPalette(img, 5)\n    log(palette)\n    if (!palette)\n      return\n    const dominantColorRGB = palette[0] // 3 element array!\n\n    if (!dominantColorRGB)\n      return\n    log(dominantColorRGB)\n\n    // if dominant color is uh, kinda in the lighter range -- txt should be black\n    const avgVal =\n      Math.round($(dominantColorRGB).map((k, v) => v).toArray().reduce((a, b) => a + b) /\n        dominantColorRGB.length)\n    const color = (avgVal >= 128 ? 'black' : 'white')\n    log('avgVal', avgVal)\n\n    $('.welcome').css({\n      color,\n      'background-color': `rgb(${dominantColorRGB.join(',')})`,\n    })\n    $('.welcome .stealth:not(.tabby .stealth)').css({ color })\n  }\n\n\n  /**\n   * Use the following function to make an image, div, etc focusable, and 'click'-able.\n   * Function adds a tabindex for 'focus' and listens for a keydown/keypress of enter or space,\n   * then triggers a click.\n   *\n   * var element: String used for jquery capture of non-acessible & mouse-only element.\n   *    ex: \"#AmazonPayButton img\"\n   * Triggers 'click' on element.\n   */\n  static makeMouseElementAccessible(element) {\n    $(element).attr('tabindex', '0').on('keypress keydown', function makeMouseElementAccessibleGo(e) {\n      if (e.type !== 'click') {\n        const code = (e.keyCode || e.which)\n        const k_space = 32 // space bar pressed\n        const k_enter = 13 // enter key pressed\n        if ([k_space, k_enter].indexOf(code) !== -1)\n          $(this).click()\n      }\n    })\n  }\n\n\n  // use something like ',' for the optional 3rd arg if you want to allow\n  // for appending 2+ values into a field, etc...\n  static autocomplete(selector, options, multiValSplitChar) {\n    $(selector).autocomplete({\n      appendTo: '#autocompletee',\n      minLength: 0,\n      source: (request, response) => {\n        // delegate back to autocomplete, but extract the last term\n        response($.ui.autocomplete.filter(options, request.term.split(/,\\s*/).pop()))\n      },\n      focus: () => false, // prevent value inserted on focus\n      select: function autocomplete_select(event, ui) {\n        if (multiValSplitChar) {\n          const terms = this.value.split(/,\\s*/)\n          // remove the current input\n          terms.pop()\n          // add the selected item\n          terms.push(ui.item.value)\n          // add placeholder to get the comma-and-space at the end\n          terms.push('')\n          this.value = terms.join(', ')\n        } else {\n          this.value = ui.item.value\n        }\n        return false\n      },\n    })\n  }\n\n\n  static addNotes(kind, htm) {\n    // flag lists have multiple users so the \"rights\" there\n    // is a bit to thorny right now so for simplicity and\n    // the main feature to go live, skipping them...\n    if (kind !== 'favorite'  &&  kind !== 'list')\n      return htm\n\n    if (!htm  &&  $('body').hasClass('editable'))\n      AJS.addingNotesKind = kind\n    if (!AJS.addingNotesKind)\n      return htm\n\n    AJS.addNoteHTM = $(`\n<div class=\"note\">\n  <span class=\"edit\">\n    <a href=\"#\" onclick=\"return AJS.editNote(this)\">Add a Note</a>\n  </span>\n</div>`)\n\n    log('addNotes')\n\n    // Next, we are going to do a global DOM search and insert (where needed)\n    // for basically the first page load.  But we're also called in \"infinite scroll\"\n    // page 2+ mode, and in that case, we want to modify (JUST) the HTM when that's\n    // for page 2+ and about to be inserted into the DOM, *instead* of another global\n    // DOM search.\n    if (htm) {\n      // (Basically we are now doing page 2+ in infinite scroll)\n      // OK this is sorta wild/maybe not obvi...a\n      // (Kinda like a jQuery replace_regexp()...)\n      // Take the *string* of HTM we are passed, convert it to a \"findable\" jQuery object\n      // then insertd \"addNoteHTM\" where needed.\n      // Finally, convert back to string and return this modified version to caller.\n      const $htm = $(`<div>${htm}</div>`)\n      $htm.find('.details-ia .C234:not(:has(\".note\"))').append(AJS.addNoteHTM)\n      return $htm.html()\n    }\n\n    // this is initial page load\n    // NOTE: return value irrelevant here\n    return $('.details-ia .C234:not(:has(\".note\"))').append(AJS.addNoteHTM)\n  }\n\n\n  static editNote(e) {\n    const $e = $(e)\n    const identifier = $e.parents('.details-ia').prev().attr('data-id')\n    if (!identifier)\n      return false\n\n    const $note = $e.parents('.note')\n\n    let val = ''\n    if ($e.text() === 'edit') {\n      val = $note.find('span:first').text()\n      val = val.replace(/</g, '&lt;').replace(/>/g, '&gt;')\n    }\n    $note.hide()\n    $note.parent().append($(`\n<form class=\"form form-horizontal note\" role=\"form\" onsubmit=\"AJS.editedNote(this);return false\">\n  <div class=\"form-group\">\n    <div class=\"col-xs-2 col-md-1 col-lg-1\">\n      <b>Note:</b>\n    </div>\n    <div class=\"col-xs-10 col-md-6 col-lg-7\">\n      <textarea class=\"form-control\" name=\"comments\">${val}</textarea>\n      <div class=\"clearfix visible-xs-block\"></div>\n    </div>\n    <div class=\"clearfix visible-xs-block\"></div>\n    <div class=\"col-xs-12 col-md-5 col-lg-4 btns\">\n      <button type=\"button\" onclick=\"AJS.editedNote(this)\" class=\"btn btn-success btn-xs\">Save</button>\n      <button type=\"button\" onclick=\"AJS.editedNote(this)\" class=\"btn btn-info btn-cancel btn-xs\">Cancel</button>\n      <button type=\"button\" onclick=\"AJS.editedNote(this)\" class=\"btn btn-danger btn-xs ${val ? '' : 'hidden'}\">Remove</button>\n    </div>\n  </div>\n</form>`))\n\n    return false\n  }\n  static editedNote(e) {\n    let $e = $(e)\n\n    const identifier = $e.parents('.details-ia').prev().attr('data-id')\n    if (!identifier)\n      return\n\n    // if user hit [return] and submitted form, etc.\n    // treat it like they hit the [Save] button\n    if ($e.is('form'))\n      $e = $e.find('button:contains(\"Save\")')\n\n    const action = $e.text()\n    const $parent = $e.parents('.note')\n    const $origNote = $parent.prev()\n\n    if (action === 'Save'  ||  action === 'Remove') {\n      const val  = (action === 'Save' ? $parent.find('textarea').val() : '')\n      const  url = '/bookmarks.php?identifier='.concat(\n        identifier, '&kind=', AJS.addingNotesKind,\n        '&add_comment=', encodeURIComponent(val),\n      )\n      log('get ', url)\n      $.get(url, () => {\n        const htm = (val ?\n          `Note: \"<span>${val.replace(/</g, '&lt;').replace(/>/g, '&gt;')}</span>\"\n          <span class=\"edit\">(<a href=\"#\" onclick=\"return AJS.editNote(this)\">edit</a>)</span>` :\n          AJS.addNoteHTM.html())\n        // show the \"Note: ...\" section again (with now appropriately updated innards)\n        $origNote.html(htm).show()\n        $parent.remove() // lose the form\n      })\n      return\n    }\n    // else Cancel does nothing but below...\n\n    $origNote.show() // show the \"Note: ...\" section again\n    $parent.remove() // lose the form\n  }\n\n\n  static thumbzilla(id) {\n    /* global  TV2  TV3 */\n    // cover entire screen with new div...\n    const TV = $('body').hasClass('tv')\n    if (TV)\n      TV2.unplay('thumbzilla')\n\n    // get list of thumbs\n    let htm = ''\n    $(AJS.thumbzillas).each((key, val) => {\n      const start = parseInt(val, 10)\n      if (TV) {\n        const startend = `/start/${start}/end/${start + TV3.CLIP_SEC_MAX2}`\n        htm += `<a onclick=\"$('#opscreen1M').fadeOut('slow'); TV2.seekURL('${startend}')\" href=\"${startend}\">`\n      } else {\n        const locNEW = `/details/${id}&start=${start}`\n        htm += `<a onclick=\"$('#opscreen1M').fadeOut('slow'); return Play.seek(this)\" href=\"${locNEW}\">`\n      }\n      htm += `<img src=\"/download/${id}/${id}.thumbs/${id}_${val}.jpg\"/></a>`\n    })\n\n    if (htm === '') {\n      // eslint-disable-next-line  no-alert\n      alert('coming soon!')\n      return false\n    }\n\n    $('#opscreen1M').remove()\n    $('body').prepend($('<div />').attr({ id: 'opscreen1M' }))\n\n    const $imgs = $('<div/>').attr({ id: 'thumbzilla' }).html(`<div>${htm}</div>`)\n    $imgs.appendTo('#opscreen1M')\n    $('#opscreen1M').css('visibility', 'hidden').show()\n    const winH = $(window).height() + (AJS.ios ? 60 : 0) // plus iOS bleah\n    for (let w = 160; w >= 10; w -= 10) {\n      const h = Math.round(w * (110 / 160.0))\n      log('TRYING', w, 'x', h)\n      $('#thumbzilla img').css({ width: w, height: h })\n      if ($('#thumbzilla img:last').offset().top + h <= winH)\n        break\n    }\n\n    $('#thumbzilla div').center()\n    $('#opscreen1M').hide().css('visibility', 'visible').fadeIn('slow')\n      .one('click.opscreen1M.nixer', () => $('#opscreen1M').fadeOut('slow'))\n    return false\n  }\n\n  /* Wayback Machine form type-ahead setup: it presents a list of sites\n      matching the text as user types. */\n  static nav_tophat_wb_setup() {\n    // Configuration\n    const WAYBACK = 'https://web.archive.org'\n    const HOSTS_ENDPOINT =   `${WAYBACK}/__wb/search/host?q=`\n    const ANCHORS_ENDPOINT = `${WAYBACK}/__wb/search/anchor?q=`\n    const REDIRECT_URL =     `${WAYBACK}/web/*/`\n    const REDIRECT_SEARCH =  `${WAYBACK}/web/*/`\n\n    function search_or_calendar(query) {\n      if (query.indexOf('http://') === 0 ||\n          query.indexOf('https://') === 0 ||\n          query.match(/[\\w.]{2,256}\\.[a-z]{2,4}/gi))\n        document.location.href = REDIRECT_URL + query\n      else\n        document.location.href = REDIRECT_SEARCH + encodeURIComponent(query)\n    }\n\n    const $input = $('#nav-wb-url')\n    const $form = $input.parent('form')\n    $form.submit((e) => {\n      AJS.fireAnalyticsTrackingEvent('HomePageWayback', 'SearchForm')\n      const query = $input.val()\n      search_or_calendar(query)\n      e.preventDefault()\n      return false\n    })\n    $input.on('focus input paste', () => {\n      if (typeof $input.typeahead === 'undefined') {\n        $.ajax({\n          url: '/includes/node_modules/bootstrap-3-typeahead/bootstrap3-typeahead.min.js',\n          dataType: 'script',\n          cache: true,\n        }).done(() => {\n          $input.typeahead({\n            source: (query, process) => {\n              $input.focus() // bugfix https://github.com/bassjobsen/Bootstrap-3-Typeahead/issues/150#issuecomment-197949899\n              return $.get(HOSTS_ENDPOINT + encodeURIComponent(query), (data) => {\n                if (typeof data.hosts !== 'undefined' && data.hosts.length > 0) {\n                  return process(data.hosts)\n                } else if (typeof data.isUrl !== 'undefined' &&  data.isUrl === true &&\n                          typeof data.excluded === 'undefined') {\n                  return process([{\n                    display_name: query,\n                  }])\n                }\n\n                return $.get(ANCHORS_ENDPOINT + encodeURIComponent(query), (data2) => {\n                  if (typeof data2 !== 'undefined' && data2.length > 0)\n                    return process(data2.slice(0, 5))\n                  return undefined\n                })\n              })\n            },\n            matcher: () => true,\n            displayText: item => item.display_name,\n            autoSelect: false,\n            delay: 400,\n            fitToElement: false, /* not good with long URLs */\n            minLenght: 3,\n            items: 8,\n          }).change(() => {\n            const current = $input.typeahead('getActive')\n            if (current && current.display_name === $input.val())\n              $form.submit()\n          }).on('keyup', (e) => {\n            if (e.which === 10 || e.which === 13) {\n              AJS.fireAnalyticsTrackingEvent('HomePageWayback', 'SearchForm')\n              const query = $input.val()\n              search_or_calendar(query)\n              e.preventDefault()\n              return false\n            }\n            return undefined\n          })\n        })\n      }\n    })\n  }\n\n  /* eslint-disable */\n\n  /**\n   * Helper to open a popup with JS\n   * @param int width\n   * @param int height\n   * @param string href\n   */\n  static openPopup(width, height, href) {\n    const params = {\n      height: height,\n      width: width,\n      scrollbars: 'yes',\n      resizable: 'yes',\n      toolbar: 'no',\n      directories: 'no',\n      location: 'yes',\n      menubar: 'no',\n      status: 'yes',\n    }\n\n    // Options must be expressed as comma-separated key-value pairs.\n    const options = Object.keys(params)\n      .filter(key => params[key])\n      .reduce((paramPairs, key) => paramPairs.concat(`${key}=${params[key]}`), [])\n      .join(',')\n\n    window.open(href, 'popup', options)\n  }\n\n  /**\n   * React Component, a link that opens its href in a popup instead of the same window.\n   * Height and width of the popup can be customized via props.\n   */\n  static PopupLink({children, href, height, width, title} = {}) {\n    function handleClick(event) {\n      event.preventDefault();\n      return AJS.openPopup(width, height, href);\n    }\n\n    // Include href for semantics.\n    return <a href={href} title={title} onClick={handleClick}>{children}</a>;\n  }\n\n\n  /**\n   * Render the CreativeCommonsLicenseLink React component to a DOM node with the\n   * appropriate ID.\n   */\n  static setUpCreativeCommonsLicenseLink() {\n    const root = document.querySelector('#creative_commons_license_link_react');\n\n    if (!root) {\n      return;\n    }\n\n    ReactDOM.render(<AJS.CreativeCommonsLicenseLink\n      href={root.dataset.href}\n      licenseName={root.dataset.licenseName}\n      licenseSelected={root.dataset.licenseSelected === 'true'}\n    />, root);\n  }\n  /* eslint-enable */\n\n  /**\n   * Sets up listeners on search forms to handle opening/closing the search options.\n   *\n   * @see SearchOptions.inc\n   */\n  static setUpSearchForms() {\n    const body = $(document.body)\n    const searchForms = $('.js-search-form')\n\n    /**\n     * Sets up an individual form, isolating its event listeners from the other ones.\n     *\n     * @param {HTMLFormElement} formNode\n     */\n    function setUpSearchForm(formNode) {\n      const form = $(formNode)\n      const searchBar = form.find('.js-search-bar')\n      const searchOptions = form.find('.js-search-options')\n      const keepOpenWhenChanged = searchOptions.data('keepOpenWhenChanged')\n      let formChanged = false\n\n      /**\n       * Catches web searches and redirects them to Wayback Machine. The search form must have a\n       * \"data-wayback-machine-search-url\" attribute set in order for this method to work (and the\n       * method assumes the query can be tacked onto the end of this URL). For all other kinds of\n       * searches, does nothing.\n       *\n       * @param {Event} event\n       */\n      function redirectWaybackSearches(event) {\n        const { waybackMachineSearchUrl } = this.dataset\n        const elements = $(this.elements)\n        const checkedInput = elements.filter('[name=\"sin\"]:checked')\n        const searchInput = elements.filter('[name=\"search\"]')\n        const sinValue = checkedInput.length ? checkedInput[0].value : ''\n        const searchValue = searchInput.length ? searchInput[0].value : ''\n\n        if (waybackMachineSearchUrl && sinValue === 'WEB') {\n          event.preventDefault()\n\n          window.location = [\n            // Remove trailing slash just in case.\n            waybackMachineSearchUrl.replace(/\\/$/, ''),\n            searchValue,\n          ].join('/')\n        }\n      }\n\n      function openOptions() {\n        searchOptions\n          .addClass('is-open')\n          .attr('aria-expanded', true)\n      }\n\n      function closeOptions() {\n        searchOptions\n          .removeClass('is-open')\n          .attr('aria-expanded', false)\n      }\n\n      /**\n       * Closes options if the newly focused element is outside of the form and the form\n       * is configured to close when it is no longer active.\n       *\n       * @param {HTMLElement} targetElement element being clicked or receiving focus\n       */\n      function handleFocusChange(targetElement) {\n        if (\n          !targetElement ||\n          form[0].contains(targetElement) ||\n          (keepOpenWhenChanged && formChanged)\n        )\n          return\n\n        closeOptions()\n      }\n\n      if (form.length) {\n        form.on('submit', redirectWaybackSearches)\n\n        if (!searchOptions.hasClass('is-open')) {\n          body.on('click', (event) => {\n            handleFocusChange(event.target)\n          })\n\n          form\n            .on('change', () => {\n              formChanged = true\n            })\n            .on('focusout', (event) => {\n              handleFocusChange(event.relatedTarget)\n            })\n\n          searchBar.on('focusin', () => {\n            openOptions()\n          })\n        }\n      }\n    }\n\n    searchForms.each((index, node) => setUpSearchForm(node))\n  }\n\n  /**\n   * Sets up two-way communication between the main page and a BookReader\n   * embedded in an <iframe>\n   *\n   * Due to the <iframe> the page and the BookReader must communicate using\n   * the BookReader's URL plugin, which sends and listens for \"message\"\n   * events via window.postMessage().\n   */\n  static setUpBookReaderIframe() {\n    const messageType = 'bookReaderFragmentChange'\n    const iframe = document.querySelector('#texty iframe')\n\n    // No BookReader embed, abort\n    if (!iframe) return\n\n    // URL syncing not enabled, abort\n    if (!iframe.hasAttribute('data-book-reader-sync-urls')) return\n\n    /**\n     * Updates the current page URL without reloading or adding to the\n     * browser history using the History API\n     *\n     * On browsers that don't support window.history (mainly Opera Mini),\n     * this is a no-op.\n     *\n     * @param {String} fragment the new fragment\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/History_API\n     */\n    function updateUrl(fragment) {\n      // History API not supported, abort\n      if (!('history' in window)) return\n\n      const path = replaceBookReaderFragment(\n        window.location.pathname,\n        fragment,\n      )\n\n      // Reconstruct URL with new path\n      const url = path + window.location.search + window.location.hash\n\n      window.history.replaceState({ fragment }, window.title, url)\n    }\n\n    window.addEventListener('message', (event) => {\n      // Not a recognized message type, abort\n      if (!event.data || event.data.type !== messageType) return\n\n      updateUrl(event.data.fragment)\n    })\n  }\n\n  /**\n   * Expandable/collapsible accordion component, implemented with <details>\n   * elements\n   *\n   * The JavaScript guarantees only one <details> is open at a time and\n   * scrolls the open <details>'s content into view.\n   *\n   * @see accordion.less\n   */\n  static setUpAccordions() {\n    /**\n     * Closes all <details> elements in detailsEls, except selectedDetails\n     *\n     * @param {HTMLDetailsElement[]} detailsEls\n     * @param {HTMLDetailsElement}   selectedDetails\n     */\n    function closeAllExcept(detailsEls, selectedDetails) {\n      Array.from(detailsEls)\n        .forEach((details) => {\n          if (details !== selectedDetails) {\n            // eslint-disable-next-line no-param-reassign\n            details.open = false\n          }\n        })\n    }\n\n    /**\n     * Sets up a single accordion component\n     *\n     * @param {HTMLElement} accordion\n     */\n    function setUpAccordion(accordion) {\n      /**\n       * Responds to the \"toggle\" event on a <details>\n       *\n       * @param {Event} event\n       */\n      function handleToggle(event) {\n        if (!event.target.open) return\n\n        closeAllExcept(\n          accordion.querySelectorAll('details'),\n          event.target,\n        )\n\n        // See https://www.abeautifulsite.net/smoothly-scroll-to-an-element-without-a-jquery-plugin-2\n        $('html, body').animate({\n          scrollTop: $(event.target).offset().top,\n        }, 400)\n      }\n\n      Array.from(accordion.querySelectorAll('details'))\n        .forEach((details) => {\n          details.addEventListener('toggle', handleToggle)\n        })\n\n      accordion.setAttribute('data-accordion-ready', '')\n    }\n\n    Array.from(document.querySelectorAll('[data-accordion]'))\n      .forEach(setUpAccordion)\n  }\n\n  /**\n   * Handles click on search 'Advanced Search' link.\n   *\n   * If 'Search TV news captions' is checked, we ignore the link click\n   * and create and open TV advanced search popup right on the page.\n   *\n   * @return {boolean}  true for browser to go to normal advanced search page; else false\n   */\n  static advanced_search(link) {\n    if (!AJS.is_advanced_TV_search(link))\n      return true\n\n    // this means we want TV advanced search form behaviour instead!\n    if (!AJS.adv) {\n      AJS.adv = {\n        mapping: false,\n      }\n    }\n\n    // only reload the resources below at most 1x/day\n    const ymd = new Date().toISOString().substr(0, 10) // eg: 2017-06-28\n    $.ajaxSetup({\n      cache: true,\n    })\n\n    // NOTE: using new JS Promise / jQuery Promise-ish Deferred..\n    // NOTE: if we are invoking this more than once, we reuse prior results\n    // NOTE: ymd forces reload at least once a day\n    // NOTE: if any resources happen to _already_ be loaded in <head>, use them\n    const i = 'https://archive.org/includes/'\n    $.when(\n      (typeof TV       !== 'undefined' || $.getScript(i.concat('tv.min.js?', ymd))),\n      (typeof TVSearch !== 'undefined' || $.getScript(i.concat('build/js/tvsearch.min.js?', ymd))),\n      ($.ui || $.getScript(i.concat('jquery-ui-1.10.3.min.js'))),\n      ($.ui || $.get('/includes/redmond/jquery-ui-1.10.3.min.css', (css) => {\n        $('<style />').html(css).appendTo('head') // Add CSS to page\n      })),\n      (AJS.adv.mapping || $.getJSON('/details/tv?mappings&output=json&'.concat(ymd), (mapping) => {\n        AJS.adv.mapping = mapping\n      })),\n    ).then(() => {\n      if (AJS.adv.mapping.length !== 2) {\n        // eslint-disable-next-line  no-alert\n        alert('failed to get network and program mappings!')\n        return\n      }\n\n      /* global  TVSearch */\n      TVSearch.proPick(AJS.adv.mapping, link)\n    })\n\n\n    return false\n  }\n\n\n  /**\n   * Returns whether or not 'Advanced Search' should be handled via JS\n   * (which as of now is just TV FTS to make a popup show up).\n   * Logically private.\n   *\n   * @param  {DOM element}  elm 'Advanced Search' link element that was just clicked\n   * @return {Boolean}      should handle with JS and not directly go to /advanced_search.php?\n   */\n  static is_advanced_TV_search(elm) {\n    if (location.hostname === 'web.archive.org')\n      return false\n\n    // for now at least, tracey felt should avoid handling link on IA top/home page even when\n    // TV FTS is picked.  for consistency, this is _definitely_ worth revisiting.\n    if ($(document.body).hasClass('top'))\n      return false\n\n    const $form = $(elm).parents('form')\n    if ($form.find('.js-search-options input[value=TV]').is(':checked'))\n      return $form\n\n    return false\n  }\n\n\n  /**\n   * Fires an Archive Analytics tracking event.\n   * @param {string} category\n   * @param {string} action\n   * @param {string} label\n   */\n  static fireAnalyticsTrackingEvent(category, action, label = location.pathname) {\n    if (typeof archive_analytics !== 'undefined') {\n      archive_analytics.send_ping({\n        kind: 'event',\n        ec: category,\n        ea: action,\n        el: label,\n        cache_bust: Math.random(),\n      })\n    }\n  }\n\n  /**\n   * Attaches handlers for action tracking.\n   *\n   * To enable click tracking for a link, add a `data-event-click-tracking`\n   * attribute containing the Google Analytics Event Category and Action, separated\n   * by a vertical pipe (|).\n   * e.g. `<a href=\"foobar\" data-event-click-tracking=\"TopNav|FooBar\">`\n   *\n   * To enable form submit tracking, add a `data-event-form-tracking` attribute\n   * to the `form` tag.\n   * e.g. `<form data-event-form-tracking=\"TopNav|SearchForm\" method=\"GET\">`\n   */\n  static setUpActionTracking() {\n    const clickTrackingAttributeName = 'event-click-tracking'\n    const formTrackingAttributeName = 'event-form-tracking'\n\n    function actionHandler(attributeName) {\n      return (event) => {\n        const currentTarget = $(event.currentTarget)\n        if (!currentTarget)\n          return\n        const categoryAction = currentTarget.data(attributeName)\n        if (!categoryAction)\n          return\n        const categoryActionParts = categoryAction.split('|')\n        AJS.fireAnalyticsTrackingEvent(categoryActionParts[0], categoryActionParts[1])\n      }\n    }\n\n    $(document.body).on('click', `[data-${clickTrackingAttributeName}]`, actionHandler(clickTrackingAttributeName))\n    $(`form[data-${formTrackingAttributeName}]`).on('submit', actionHandler(formTrackingAttributeName))\n  }\n\n  /**\n   * Sets up data-popup-links\n   */\n  static setupPopupLink() {\n    const attributeName = 'popup-link'\n    const widthAttribute = 'popup-link-width'\n    const heightAttribute = 'popup-link-height'\n\n    $(document.body).on('click', `[data-${attributeName}]`, (event) => {\n      event.preventDefault()\n      const currentTarget = $(event.currentTarget)\n      const w = currentTarget.data(widthAttribute) || 500\n      const h = currentTarget.data(heightAttribute) || 500\n      AJS.openPopup(w, h, event.currentTarget.href)\n    })\n  }\n\n  /**\n   * React functional component. Renders related item tiles on details page.\n   * This markup is *duplicated between the JS and PHP to render tiles.\n   *\n   * @see Tiles::construct()\n   *\n   * @param {Object} params\n   * @param {Array}  params.dataHash\n   * @return {JSX.ElementClass}\n   */\n  static RelatedItemSection({ dataHash = [] }) {\n    return (\n      <section aria-label=\"Related Items\">\n        {dataHash.map(item => (\n          <div className=\"results\">\n            <div className=\"item-ia\" data-id={item.identifier} data-mediatype={item.mediatype} data-year=\"\">\n              <a className=\"stealth\" tabIndex=\"-1\" href={`/details/${item.identifier}`}>\n                <div className=\"hidden-tiles views C C1\">\n                  <span className=\"hidden-xs\">{item.downloads}</span>\n                  <span className=\"hidden-sm hidden-md hidden-lg\">{item.downloads}</span>\n                </div>\n              </a>\n\n              <div className=\"C234\">\n                <div className={`item-ttl ${item.lendClass} C C2`}>\n                  <a href={`/details/${item.identifier}`} title={item.title} data-event-click-tracking=\"GenericNonCollection|ItemTile\">\n                    <div className=\"tile-img\">\n                      <img className=\"item-img\" alt=\"\" src={`/services/img/${item.identifier}`} />\n                    </div>\n\n                    {(item.lendingEnabled === true && item.lendingAvailable === true) &&\n                      <div className=\"tile-action hidden-lists\">Borrow</div>\n                    }\n\n                    {(item.lendingEnabled === true && item.lendingAvailable === false) &&\n                      <div className=\"tile-action hidden-lists\">Join Waitlist</div>\n                    }\n\n                    {(item.loginRequired === true) &&\n                      <div className=\"tile-action hidden-lists\">Log in to view this item</div>\n                    }\n\n                    <div className=\"ttl\">{item.title}</div>\n                  </a>\n                </div>\n\n                <div className=\"by C C4\">\n                  {(item.creator !== '') &&\n                    <div>\n                      <span className=\"hidden-lists\">by </span>\n                      <span className=\"byv\" title={item.creator}>{item.creator}</span>\n                    </div>\n                  }\n                </div>\n              </div>\n\n              <div className=\"statbar \">\n                <div className=\"mt-icon C C5\">\n                  <span className={`iconochive-${item.mediatype}`} aria-hidden=\"true\">&nbsp;</span>\n                  <span className=\"sr-only\">{item.mediatype}</span>\n                </div>\n\n                <h6 className=\"stat\">\n                  <span className=\"iconochive-eye\" aria-hidden=\"true\">&nbsp;</span>\n                  <span className=\"sr-only\">eye</span><span>{item.downloads}</span>\n                </h6>\n\n                <h6 className=\"stat\">\n                  <span className=\"iconochive-favorite\" aria-hidden=\"true\">&nbsp;</span>\n                  <span className=\"sr-only\">favorite</span>{item.favorite}\n                </h6>\n\n                <h6 className=\"stat\">\n                  <span className=\"iconochive-comment\" aria-hidden=\"true\">&nbsp;</span>\n                  <span className=\"sr-only\">comment</span>{item.numReviews}\n                </h6>\n              </div>\n            </div>\n          </div>\n        ))}\n      </section>\n    )\n  }\n\n  /**\n   * React functional component. Renders a table showing view stats per geographic region for an\n   * item or collection.\n   *\n   * @see stats-table.less\n   *\n   * @param {Object} props\n   * @param {String} props.caption\n   * @param {GeoCount[]} props.counts\n   * @return {String}\n   */\n  static RegionsTable({ caption = 'Regions', captionClass = '', counts = [] }) {\n    return (\n      <table className=\"stats-table\">\n        <caption className={captionClass}>{caption}</caption>\n\n        <thead>\n          <tr>\n            <th scope=\"col\">Region</th>\n            <th scope=\"col\">Country</th>\n            <th className=\"stats-table__numeric-column\" scope=\"col\">Views</th>\n          </tr>\n        </thead>\n\n        <tbody>\n          {counts.map(count => (\n            <tr key={`${count.state.code}_${count.country.code}_${count.count}`}>\n              <td>{count.state.formattedName}</td>\n              <td>{count.country.formattedName}</td>\n              <td className=\"stats-table__numeric-column\">{count.formattedCount}</td>\n            </tr>\n          ))}\n        </tbody>\n      </table>)\n  }\n\n  /**\n   * React functional component. Renders a message to display while a resource is loading.\n   *\n   * @see loading-message.less\n   *\n   * @param {Object} props\n   * @param {String} props.message\n   * @return {String}\n   */\n  static LoadingMessage({ message = 'Loading' }) {\n    return <small className=\"loading-message\">{message}</small>\n  }\n\n  /**\n   * React functional component. Renders a error message.\n   *\n   * @param {Object} props\n   * @param {String} props.errorMsg\n   * @return {JSX.ElementClass}\n   */\n  static ErrorMessage({ errorMsg }) {\n    return <small>{errorMsg}</small>\n  }\n\n  /**\n   * Finds an element with class \"js-top-regions-table\" and renders a table showing the top 10\n   * regions in terms of views for an item/collection.\n   *\n   * Data Attributes:\n   *  - data-caption (string)\n   *  - data-caption-class (string)\n   *  - data-days (number)\n   *  - data-identifier (string)\n   *  - data-limit (number)\n   */\n  static setUpTopRegionsTable() {\n    const root = $('.js-top-regions-table')\n    const message = root.find('.js-top-regions-message')\n    const originalMessageText = message.text()\n\n    if (!root || !message)\n      return\n\n    ReactDOM.render(<AJS.LoadingMessage message=\"loading data\" />, message[0])\n\n    const apiOptions = {\n      uaKinds: ['non_robot', 'unrecognized'],\n    }\n\n    if (root.data('days'))\n      apiOptions.days = parseInt(root.data('days'), 10)\n\n    if (root.data('limit'))\n      apiOptions.limit = parseInt(root.data('limit'), 10)\n\n    AJS.StatsApiClient.getGeoCounts(root.data('identifier'), apiOptions).then(\n      (counts) => {\n        ReactDOM.render(<AJS.RegionsTable\n          caption={root.data('caption')}\n          captionClass={root.data('captionClass')}\n          counts={counts}\n        />, root[0])\n      },\n      () => {\n        // If API call fails, fall back to original text.\n        message.text(originalMessageText)\n      },\n    )\n  }\n} // end class AJS\n\n\nclass Timegraf {\n  // class for facets section interactive time-related graph.\n  // Graph shows search results histogramed over time.\n  // It allows user to drag left and right 'handles' overlaying the graph to constrain to a\n  // smaller time period.\n  static timechanged = false\n  static c = {} // config that comes from PHP\n\n  static setup(leftTS, riteTS, minDate, maxDate) {\n    Timegraf.c.realGraphWidth = Timegraf.c.GRAPH_WIDTH - Timegraf.c.GRAPH_PADDING\n    Timegraf.c.maxSlide = Math.floor((maxDate.getTime() - minDate.getTime()) / 86400000)\n    const csMinTS = minDate.getTime() / 1000\n    const left = leftTS > 0 ? Math.floor((leftTS - csMinTS) / 86400) : 0\n    const rite = riteTS > 0 ? Math.floor((riteTS - csMinTS) / 86400) : Timegraf.c.maxSlide\n\n\n    const $sliderdiv = $('<div />').attr({ id: 'slider' }).css({\n      width: Timegraf.c.realGraphWidth,\n      position: 'absolute',\n      top: (Timegraf.c.GRAPH_HEIGHT - 10),\n      left: 0,\n      zIndex: 1,\n    })\n    $('#timegraf').append($sliderdiv)\n    $sliderdiv.append('<br />') // bleah!\n\n\n    log(left, rite)\n\n    $('#slider').slider({\n      range: true,\n      max: Timegraf.c.maxSlide,\n      values: [left, rite],\n      slide: (event, ui) => {\n        const ts = minDate.getTime()\n        const d1 = new Date(ts)\n        const d2 = new Date(ts)\n\n        d1.setDate(d1.getDate() + ui.values[0])\n        d2.setDate(d2.getDate() + ui.values[1])\n\n        $('#from ').html($.datepicker.formatDate('M d', d1)) // Jan 19\n        $('#to   ').html($.datepicker.formatDate('M d', d2)) // Jan 19\n        $('#fromB').html($.datepicker.formatDate('yymmdd', d1)) // yyyymmdd\n        $('#toB  ').html($.datepicker.formatDate('yymmdd', d2)) // yyyymmdd\n        $('#datepickL').val($.datepicker.formatDate('mm/dd/yy', d1)) // mm/dd/yyyy\n        $('#datepickR').val($.datepicker.formatDate('mm/dd/yy', d2)) // mm/dd/yyyy\n\n\n        clearTimeout(Timegraf.hideL)\n        clearTimeout(Timegraf.hideR)\n\n        const foff = { left: ($('#slider .ptrL').offset().left - $('#from').width()) + 10 }\n        const toff = { left:  $('#slider .ptrR').offset().left }\n        /* eslint-disable  brace-style */\n        $('#from').offset(foff).show(0, () => { Timegraf.hideL = setTimeout(() => $('#from').hide('slow'), 2000) })\n        $('#to  ').offset(toff).show(0, () => { Timegraf.hideR = setTimeout(() => $('#to  ').hide('slow'), 2000) })\n        /* eslint-enable  brace-style */\n\n        Timegraf.pinkme(ui.values[0], ui.values[1])\n      },\n      stop: (event, ui) => {\n        Timegraf.adjust(ui.values[0], ui.values[1])\n        Timegraf.timechanged = true\n        const now = location.href.replace(/^http[s]*:/, '')\n        const become = `//${location.host}${Timegraf.c.q}${Timegraf.args()}`\n\n        if (now !== become) {\n          log(now)\n          log(become)\n\n          // make it more obvious that search is being issued\n          $('#opscreen1M').remove()\n          $('body').append($('<div id=\"opscreen1M\"/>'))\n          $('#opscreen1M').show('slow', () => {\n            location.href = become\n          })\n        }\n      },\n    })\n\n    if (left > 0  ||  rite > 0)\n      Timegraf.pinkme(left, rite)\n  }\n\n  static pinkme(left, rite) {\n    const x = Math.round(Timegraf.c.GRAPH_PADDING / 2)\n    const pinkL = (Math.round((left / Timegraf.c.maxSlide) * Timegraf.c.realGraphWidth) + 2)\n    const pinkR = (Math.round((rite / Timegraf.c.maxSlide) * Timegraf.c.realGraphWidth) - 2) + x\n\n    const rect = `rect(0px,${pinkR}px,${Timegraf.c.GRAPH_HEIGHT}px,${pinkL}px)`\n    log(rect)\n    $('#timegraf-clip').css('clip', rect)\n\n    const ttl = 'click and drag this to change time period'\n    const attr = { 'data-title': ttl, 'data-toggle': 'tooltip', 'data-placement': 'bottom' }\n    $($('#slider a').get(0)).attr(attr).removeClass('ui-state-default').addClass('ptrL')\n    $($('#slider a').get(1)).attr(attr).removeClass('ui-state-default').addClass('ptrR')\n\n    Timegraf.adjust(left, rite)\n  }\n\n  static adjust(left, rite) {\n    const onedayspan = (rite - left < 2)\n\n    log('left:', left, 'rite:', rite)\n\n    if (onedayspan) {\n      $('#to').hide()\n      $('#slider .ui-widget-header').css('borderColor', '#d33682')\n      $('#slider .ui-widget-header').css('border-left-width', 0)\n    } else {\n      $('#slider .ui-widget-header').css('borderColor', '#d33682')\n      $('#slider .ui-widget-header').css('border-left-width', 2)\n    }\n  }\n\n  static args() {\n    if (!Timegraf.timechanged)\n      return ''\n    const from2 = $('#fromB').text().trim()\n    const   to2 = $('#toB  ').text().trim()\n    const end = (from2 === to2 ? '' : `-${to2}`)\n    return `&time=${from2}${end}` // TVII\n  }\n} // end class Timegraf\n\n\n(function defineStatsApi() {\n  /**\n   * @param {String} source\n   * @return {String}\n   */\n  function capitalizeFirstLetter(source) {\n    return source.charAt(0).toUpperCase() + source.slice(1)\n  }\n\n  /**\n   * A geographic region (either a country or a state/province within a country) for the\n   * purposes of site usage statistics.\n   */\n  class StatsRegion {\n    /**\n     * @param {Object} props\n     * @param {String} props.code\n     * @param {String} props.name\n     */\n    constructor({ code, name }) {\n      this.code = code\n      this.name = name\n    }\n\n    /**\n     * @return {String}\n     */\n    get formattedName() {\n      return capitalizeFirstLetter(this.name)\n    }\n  }\n\n  /**\n   * A count of site usage from a particular state/province.\n   */\n  class GeoCount {\n    /**\n     * @param {Object} props\n     * @param {String} props.count\n     * @param {String} props.country\n     * @param {String} props.state\n     */\n    constructor({ count, country, state }) {\n      this.count = parseInt(count, 10)\n      this.country = country\n      this.state = state\n    }\n\n    /**\n     * @return {String}\n     */\n    get formattedCount() {\n      return AJS.addCommas(this.count)\n    }\n  }\n\n  /**\n   * @param {Object} data\n   * @return {GeoCount}\n   */\n  function createGeoCountFromApiData(data) {\n    return new GeoCount({\n      count: data.sum_count_value,\n\n      country: new StatsRegion({\n        code: data.geo_country,\n        name: data.country,\n      }),\n\n      state: new StatsRegion({\n        code: data.geo_state,\n        name: data.state,\n      }),\n    })\n  }\n\n  /**\n   * Parse API data and produce a list of GeoCount objects, with counts made by combining sums\n   * from various kinds of user agents.\n   *\n   * @param {Object}   data must have key counts_geo\n   * @param {Object}   options\n   * @param {String[]} options.uaKinds list of user-agent kinds to include\n   * @return {GeoCount[]}\n   */\n  function createCombinedGeoCountsFromApiData(data, {\n    uaKinds = ['robot', 'non_robot', 'unrecognized'],\n  } = {}) {\n    if (!data.counts_geo)\n      throw new RangeError(\"API response doesn't contain property 'counts_geo'.\")\n\n    /**\n     * @param {String} uaKind\n     * @return {Boolean}\n     */\n    function uaKindIsAllowed(uaKind) {\n      return uaKinds.indexOf(uaKind) !== -1\n    }\n\n    const countsMap = {}\n\n    for (let i = 0; i < data.counts_geo.length; i++) {\n      const countData = data.counts_geo[i]\n\n      // Whitelist user agents and skip unknown countries.\n      if (uaKindIsAllowed(countData.ua_kind) && countData.country !== 'unknown') {\n        const mapKey = `${countData.geo_country}_${countData.geo_state}`\n\n        // Add to an existing count or create a new one.\n        if (countsMap[mapKey])\n          countsMap[mapKey].count += countData.sum_count_value\n        else\n          countsMap[mapKey] = createGeoCountFromApiData(countData)\n      }\n    }\n\n    return Object.keys(countsMap).map(key => countsMap[key])\n  }\n\n  const apiBaseUrl = 'https://be-api.us.archive.org/views/v1'\n\n  /**\n   * Interface for fetching site usage stats from the stats API.\n   */\n  AJS.StatsApiClient = class StatsApiClient {\n    /**\n     * @param {String} identifier\n     * @param {Object} options\n     * @param {Number} options.days\n     * @param {Number} options.limit\n     * @return {jQuery.Promise<GeoData[]>}\n     */\n    static getGeoCounts(identifier, {\n      days = 30,\n      limit = 100,\n      uaKinds = ['robot', 'non_robot', 'unrecognized'],\n    } = {}) {\n      const url = `${apiBaseUrl}/detail/collection/${identifier}/${days}`\n\n      return $.get(url)\n        .then((data) => {\n          try {\n            return createCombinedGeoCountsFromApiData(data, { uaKinds })\n              .sort((count1, count2) => (count1.count < count2.count ? 1 : -1))\n              .slice(0, limit)\n          } catch (error) {\n            return $.Deferred().reject(error)\n          }\n        })\n    }\n  }\n}())\n\n/* eslint-disable */\n\n/**\n * React component, Creative Commons license selector link.\n * Shows a \"remove\" link when a license is selected.\n */\nAJS.CreativeCommonsLicenseLink = React.createClass({\n  DEFAULT_LINK_TEXT: 'Choose license',\n\n  defaultProps: {\n    licenseName: undefined,\n    licenseSelected: false,\n  },\n\n  getInitialState() {\n    return {\n      licenseSelected: this.props.licenseSelected,\n      linkText: this.props.licenseName || this.DEFAULT_LINK_TEXT,\n      oldLicenseName: this.props.licenseName,\n    };\n  },\n\n  componentWillReceiveProps(newProps) {\n    this.setState({\n      licenseSelected: newProps.licenseSelected,\n      linkText: newProps.licenseName || this.DEFAULT_LINK_TEXT,\n    });\n  },\n\n  removeLicense() {\n    this.setState({\n      licenseSelected: false,\n      linkText: this.DEFAULT_LINK_TEXT,\n    });\n\n    this.removeRetainLicenseInput();\n  },\n\n  /**\n   * This is left over from the old, non-React version of this widget, so\n   * we need to reach outside of the React component and change another DOM node.\n   */\n  removeRetainLicenseInput() {\n    const formItem = document.getElementById('retaincclicense');\n    formItem.parentNode.removeChild(formItem);\n  },\n\n  wasLicensedChanged() {\n    return this.state.oldLicenseName !== this.state.linkText;\n  },\n\n  getLicenseChangeMessage() {\n    if (this.state.oldLicenseName && this.wasLicensedChanged()) {\n      return `Change license (currently ${this.state.oldLicenseName})`;\n    }\n\n    return '';\n  },\n\n  render() {\n    return <span>\n      <AJS.PopupLink\n        href={this.props.href}\n        height=\"600\"\n        width=\"600\"\n        title={this.getLicenseChangeMessage()}\n      >{this.state.linkText}</AJS.PopupLink>\n\n      {' '}\n\n      {this.state.licenseSelected &&\n        <span>\n          (<button\n            type=\"button\"\n            className=\"creativecommons-remove-license-button\"\n            onClick={this.removeLicense}\n          >remove</button>)\n        </span>\n      }\n    </span>;\n  },\n})\n/* eslint-enable */\n\nAJS.MORFreact = React.createClass({\n  FACETS_PER_PAGE: 100,\n\n  getInitialState() {\n    return {\n      page: 1,\n      href: '',\n      mounted: false,\n      hdr: '',\n      options: [],\n    }\n  },\n\n  getFacets() {\n    const self = this\n    // xxxx Math.rand anti-browser caching etc??\n    $.getJSON(`${this.props.href}&headless=1&output=json`, (ret) => {\n      // eslint-disable-next-line  no-param-reassign\n      ret.href = self.props.href\n      // eslint-disable-next-line  no-param-reassign\n      ret.mounted = true\n      log(ret)\n\n      self.setState(ret)\n\n      // now check all the boxes that user has previously/currently checked\n      for (let j = 0; j < ret.checked.length; j++) {\n        for (let i = 0; i < self.state.options.length; i++) {\n          const { val } = self.state.options[i]\n          // NOTE: == not === so \"1970\"==1970 (eg: year facet)\n          // eslint-disable-next-line  eqeqeq\n          if (ret.checked[j] == val) {\n            self.refs[val].checked = true\n            break\n          }\n        }\n      }\n    })\n  },\n\n  componentDidMount() {\n    // Our component is visible in page now, effectively empty\n    // Now ask server for facets to render in\n    log('mounted')\n    this.getFacets()\n  },\n\n  pageClick(e) {\n    e.stopPropagation()\n    e.preventDefault()\n\n    // if user clicked on the |> \"next page\" icon, advance one page;\n    // else they clicked on a specific page number to go to\n    const page = ($(e.target).text() === '' ? this.state.page + 1 : parseInt($(e.target).text(), 10))\n    this.setState({ page })\n  },\n\n  submitClick() {\n    log('submitted')\n    let url = this.state.submit\n    for (let i = 0; i < this.state.options.length; i++) {\n      const { val } = this.state.options[i]\n      if (this.refs[val].checked) {\n        const tmp = `&and[]=${this.state.morf}%3A\"${encodeURIComponent(val)}\"`\n        log('checked', val, '=>', tmp)\n        url += tmp\n      }\n    }\n    log(url)\n    location.href = url\n  },\n\n  render() {\n    log('rendering..')\n    // log(this.props.href)\n    // log(this.state.href)\n\n    let loading = !this.state.mounted\n    if (this.state.href !== ''  &&  this.props.href !== this.state.href) {\n      loading = true\n      this.getFacets()\n    }\n\n    $('#morf-modal .modal-title').html(loading ? '' : this.state.hdr)\n\n    const min = (this.state.page - 1) * this.FACETS_PER_PAGE\n    const max = (min + this.FACETS_PER_PAGE) - 1\n    const options = this.state.options.map((option, n) => (\n      <div className={(n >= min && n <= max && !loading ? 'farow' : 'farow hidden')} key={option.val}>\n        <div className=\"facell\">\n          <input\n            onClick={this.handleClick}\n            type=\"checkbox\"\n            name={option.val}\n            value={option.val}\n            ref={option.val}\n          />\n        </div>\n        <div className=\"facell\">\n          {AJS.addCommas(option.n)}\n        </div>\n        <div className=\"facell\">\n          {option.txt ? option.txt : option.val}\n        </div>\n      </div>))\n\n    const paging = []\n    const npages = (Math.ceil(this.state.options.length / this.FACETS_PER_PAGE))\n    let loadnote = ''\n    if (loading) {\n      loadnote = (\n        <div style={{ 'font-style': 'italic', margin: '25px', 'text-align': 'center' }}>\n          loading filters...\n          <img alt=\"\" style={{ width: '25px' }} key={loading} src=\"/images/loading.gif\" />\n        </div>)\n    } else {\n      let page = 1\n      for (page = 1; page <= npages; page++) {\n        if (this.state.page === page)\n          paging.push(<div key={'p'.concat(page)} className=\"topinblock\">{page}</div>)\n        else\n          paging.push(<a href={'#'.concat(page)} key={'p'.concat(page)} onClick={this.pageClick}>{page}</a>)\n        paging.push(' ')\n      }\n      if (this.state.page < npages) {\n        const tmp = (\n          <a href={'#'.concat(page)} key={'pp'.concat(page)} onClick={this.pageClick}>\n            <span className=\"iconochive-right-solid\" />\n          </a>)\n        paging.push(tmp)\n      }\n    }\n    return (\n      <div id=\"morf-page\">\n        <form>\n          <div className=\"fatable facet-subject\">\n            {options}\n          </div>\n          {loadnote}\n          <div id=\"morf-paging\">\n            {paging}\n          </div>\n          <center>\n            <input className={loading ? 'btn-primary hidden' : 'btn-primary'} type=\"button\" value=\"Apply your filters\" onClick={this.submitClick} />\n          </center>\n        </form>\n      </div>\n    )\n  },\n})// end MORFreact\n\n\n/** ******************************************************************************************\n *\n *\n *    THIRD PARTY INCLUDES WE CANT LIVE WITHOUT! 8-)\n *\n *\n ******************************************************************************************** */\n\n/* eslint-disable */\n/**\n * Cookie plugin\n *\n * Copyright (c) 2006 Klaus Hartl (stilbuero.de)\n * Dual licensed under the MIT and GPL licenses:\n * http://www.opensource.org/licenses/mit-license.php\n * http://www.gnu.org/licenses/gpl.html\n *\n */\n\n/**\n * Create a cookie with the given name and value and other optional parameters.\n *\n * @example $.cookie('the_cookie', 'the_value');\n * @desc Set the value of a cookie.\n * @example $.cookie('the_cookie', 'the_value', { expires: 7, path: '/', domain: 'jquery.com', secure: true });\n * @desc Create a cookie with all available options.\n * @example $.cookie('the_cookie', 'the_value');\n * @desc Create a session cookie.\n * @example $.cookie('the_cookie', null);\n * @desc Delete a cookie by passing null as value. Keep in mind that you have to use the same path and domain\n *       used when the cookie was set.\n *\n * @param String name The name of the cookie.\n * @param String value The value of the cookie.\n * @param Object options An object literal containing key/value pairs to provide optional cookie attributes.\n * @option Number|Date expires Either an integer specifying the expiration date from now on in days or a Date object.\n *                             If a negative value is specified (e.g. a date in the past), the cookie will be deleted.\n *                             If set to null or omitted, the cookie will be a session cookie and will not be retained\n *                             when the the browser exits.\n * @option String path The value of the path atribute of the cookie (default: path of page that created the cookie).\n * @option String domain The value of the domain attribute of the cookie (default: domain of page that created the cookie).\n * @option Boolean secure If true, the secure attribute of the cookie will be set and the cookie transmission will\n *                        require a secure protocol (like HTTPS).\n * @type undefined\n *\n * @name $.cookie\n * @cat Plugins/Cookie\n * @author Klaus Hartl/klaus.hartl@stilbuero.de\n */\n\n/**\n * Get the value of a cookie with the given name.\n *\n * @example $.cookie('the_cookie');\n * @desc Get the value of a cookie.\n *\n * @param String name The name of the cookie.\n * @return The value of the cookie.\n * @type String\n *\n * @name $.cookie\n * @cat Plugins/Cookie\n * @author Klaus Hartl/klaus.hartl@stilbuero.de\n */\n$.cookie = function(name, value, options) {\n  if (typeof value != 'undefined') { // name and value given, set cookie\n      options = options || {};\n      if (value === null) {\n          value = '';\n          options.expires = -1;\n      }\n      var expires = '';\n      if (options.expires && (typeof options.expires == 'number' || options.expires.toUTCString)) {\n          var date;\n          if (typeof options.expires == 'number') {\n              date = new Date();\n              date.setTime(date.getTime() + (options.expires * 24 * 60 * 60 * 1000));\n          } else {\n              date = options.expires;\n          }\n          expires = '; expires=' + date.toUTCString(); // use expires attribute, max-age is not supported by IE\n      }\n\n      // CAUTION: Needed to parenthesize options.path and options.domain\n      // in the following expressions, otherwise they evaluate to undefined\n      // in the packed version for some reason...\n      var path = options.path ? '; path=' + (options.path) : '';\n      var domain = options.domain ? '; domain=' + (options.domain) : '';\n      var secure = options.secure ? '; secure' : '';\n\n      if (navigator.userAgent.indexOf('MSIE 9.')>0) { // IE9 sucks and can kiss it (tracey may2012)\n        domain='';\n        path='';\n      }\n\n      document.cookie = [name, '=', encodeURIComponent(value), expires, path, domain, secure].join('');\n      return true;\n  } else { // only name given, get cookie\n      var cookieValue = null;\n      if (document.cookie && document.cookie != '') {\n          var cookies = document.cookie.split(';');\n          for (var i = 0; i < cookies.length; i++) {\n              var cookie = $.trim(cookies[i]);\n              // Does this cookie string begin with the name we want?\n              if (cookie.substring(0, name.length + 1) == (name + '=')) {\n                  cookieValue = decodeURIComponent(cookie.substring(name.length + 1));\n                  break;\n              }\n          }\n      }\n      return cookieValue;\n  }\n}\n/* eslint-enable */\n\n\n// (adapted) from http://www.queness.com/code-snippet/6853/center-an-element-on-the-screen-using-jquery\n// then you can use it like:\n//      $(\"#gridmini\").center()\n\n// eslint-disable-next-line  no-param-reassign\n$.fn.center = function jquery_extension_center() {\n  const myheight = (this.height() +\n                    parseInt(this.css('padding-top'), 10) +\n                    parseInt(this.css('padding-bottom'), 10))\n\n  log('myheight', myheight)\n  log('mywidth', this.width())\n  log(\n    'w.height', $(window).height(),\n    'w.width', $(window).width(),\n    'w.scrollTop', $(window).scrollTop(),\n    'w.scrollLeft', $(window).scrollLeft(),\n  )\n\n\n  let top\n  let left\n  if (AJS.ios) {\n    const vpW = window.innerWidth\n    const vpH = window.innerHeight\n\n    log('vpH', vpH)\n    log('vpW', vpW)\n\n    top  = ((vpH -     myheight) / 2)  +  $(window).scrollTop()\n    left = ((vpW - this.width()) / 2)  +  $(window).scrollLeft()\n  } else {\n    top  = ($(window).height() - myheight) / 2\n    left = ($(window).width()  - this.width()) / 2\n  }\n\n  // for small viewports like iphone, when centering popups, ensure minimally +20px\n  top  = Math.max(20, top)\n  left = Math.max(20, left)\n\n  this.css({\n    position: (AJS.ios ? 'absolute' : 'fixed'),\n    display:  'block',\n    top,\n    left,\n  })\n\n  return this\n} // end $.fn.center\n\n\n$(() => {\n  // Use this global hack, by adding class 'accessible-link' to any mouse-only element div/img\n  AJS.makeMouseElementAccessible('.accessible-link')\n\n\n  AJS.setUpActionTracking() // Must be before other form submit handlers are assigned\n  AJS.nav_tophat_setup()\n  AJS.nav_tophat_wb_setup()\n\n  // UI component initialization\n  AJS.setupPopupLink()\n  AJS.setUpCreativeCommonsLicenseLink()\n  AJS.setUpSearchForms()\n  AJS.setUpBookReaderIframe()\n  AJS.setUpAccordions()\n  AJS.setUpRelatedItems()\n  setUpCopyableTexts()\n\n  /* global  archive_setup */\n  if (typeof archive_setup !== 'undefined') {\n    // when DOM loaded/stable, do some setup\n    $(() => {\n      for (const fn of archive_setup)\n        fn()\n    })\n  }\n\n  AJS.footer()\n})\n\n\n// promote to globals:\nwindow.AJS = AJS\nwindow.Timegraf = Timegraf\n","/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// define __esModule on exports\n/******/ \t__webpack_require__.r = function(exports) {\n/******/ \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t};\n/******/\n/******/ \t// create a fake namespace object\n/******/ \t// mode & 1: value is a module id, require it\n/******/ \t// mode & 2: merge all properties of value into the ns\n/******/ \t// mode & 4: return value when already ns object\n/******/ \t// mode & 8|1: behave like require\n/******/ \t__webpack_require__.t = function(value, mode) {\n/******/ \t\tif(mode & 1) value = __webpack_require__(value);\n/******/ \t\tif(mode & 8) return value;\n/******/ \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n/******/ \t\tvar ns = Object.create(null);\n/******/ \t\t__webpack_require__.r(ns);\n/******/ \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n/******/ \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n/******/ \t\treturn ns;\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ \"./src/scripts/index.js\":\n/*!******************************!*\\\n  !*** ./src/scripts/index.js ***!\n  \\******************************/\n/*! no static exports found */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar IaDesignSystem = {};\n\n// Add components as keys in the IaDesignSystem object, for example:\n//    import MyComponent from 'components/MyComponent';\n//    IaDesignSystem.MyComponent = MyComponent;\n\nexports.default = IaDesignSystem;\n\n/***/ }),\n\n/***/ \"./src/styles/index.less\":\n/*!*******************************!*\\\n  !*** ./src/styles/index.less ***!\n  \\*******************************/\n/*! no static exports found */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 0:\n/*!************************************************************!*\\\n  !*** multi ./src/scripts/index.js ./src/styles/index.less ***!\n  \\************************************************************/\n/*! no static exports found */\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(/*! /Users/mitra/Library/Caches/Yarn/v6/.tmp/f85d5c6dbf48ced4703e8bc19ab1e947.5c04a7b880a402fa16e48933f5ca7327747203dc.prepare/src/scripts/index.js */\"./src/scripts/index.js\");\nmodule.exports = __webpack_require__(/*! /Users/mitra/Library/Caches/Yarn/v6/.tmp/f85d5c6dbf48ced4703e8bc19ab1e947.5c04a7b880a402fa16e48933f5ca7327747203dc.prepare/src/styles/index.less */\"./src/styles/index.less\");\n\n\n/***/ })\n\n/******/ });\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL3NjcmlwdHMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3N0eWxlcy9pbmRleC5sZXNzIl0sIm5hbWVzIjpbIklhRGVzaWduU3lzdGVtIl0sIm1hcHBpbmdzIjoiO0FBQUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxrREFBMEMsZ0NBQWdDO0FBQzFFO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsZ0VBQXdELGtCQUFrQjtBQUMxRTtBQUNBLHlEQUFpRCxjQUFjO0FBQy9EOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBeUMsaUNBQWlDO0FBQzFFLHdIQUFnSCxtQkFBbUIsRUFBRTtBQUNySTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLG1DQUEyQiwwQkFBMEIsRUFBRTtBQUN2RCx5Q0FBaUMsZUFBZTtBQUNoRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSw4REFBc0QsK0RBQStEOztBQUVySDtBQUNBOzs7QUFHQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNsRkEsSUFBTUEsaUJBQWlCLEVBQXZCOztBQUVBO0FBQ0E7QUFDQTs7a0JBRWVBLGM7Ozs7Ozs7Ozs7O0FDTmYseUMiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCJjb25zdCBJYURlc2lnblN5c3RlbSA9IHt9O1xuXG4vLyBBZGQgY29tcG9uZW50cyBhcyBrZXlzIGluIHRoZSBJYURlc2lnblN5c3RlbSBvYmplY3QsIGZvciBleGFtcGxlOlxuLy8gICAgaW1wb3J0IE15Q29tcG9uZW50IGZyb20gJ2NvbXBvbmVudHMvTXlDb21wb25lbnQnO1xuLy8gICAgSWFEZXNpZ25TeXN0ZW0uTXlDb21wb25lbnQgPSBNeUNvbXBvbmVudDtcblxuZXhwb3J0IGRlZmF1bHQgSWFEZXNpZ25TeXN0ZW07XG4iLCIvLyByZW1vdmVkIGJ5IGV4dHJhY3QtdGV4dC13ZWJwYWNrLXBsdWdpbiJdLCJzb3VyY2VSb290IjoiIn0=","import ClipboardJS from 'clipboard'\n\n/**\n * Shows a message indicating the status of the copy operation\n *\n * Sets proper ARIA properties to ensure the status is read out by\n * accessible technologies\n *\n * @param {HTMLElement} copyableText\n * @param {String}      message\n */\nfunction showStatusMessage(copyableText, message) {\n  let output = copyableText.querySelector('output')\n\n  if (!output) {\n    output = document.createElement('output')\n    output.setAttribute('role', 'alert')\n    copyableText.appendChild(output)\n  }\n\n  // Empty it first to trigger accessibility technologies to read out the\n  // value even if it's the same as before\n  output.textContent = ''\n  output.textContent = message\n}\n\n/**\n * Creates a copy button with an event listener that triggers the\n * copy operation\n *\n * @param {HTMLElement} copyableText\n */\nfunction createButton(copyableText) {\n  const button = document.createElement('button')\n  button.type = 'button'\n  button.textContent = 'Copy'\n  button.title = 'Copy to clipboard'\n  button.setAttribute('data-clipboard-target', `#${copyableText.querySelector('input').id}`)\n\n  return button\n}\n\n/**\n * Sets up a specific copyable text component\n *\n * @param {HTMLElement} copyableText\n */\nfunction setUpCopyableText(copyableText) {\n  // No <input> to copy, abort\n  if (!copyableText.querySelector('input')) return\n\n  copyableText.appendChild(createButton(copyableText))\n\n  // Mark it as \"ready\" so we can avoid double-initializing\n  copyableText.setAttribute('data-copyable-text-ready', '')\n}\n\n/**\n * Initialize ClipboardJS behavior for all buttons and attach event listeners to show statuses\n */\nfunction setUpClipboardJS() {\n  const clipboard = new ClipboardJS('[data-copyable-text] [data-clipboard-target]')\n\n  clipboard.on('success', (event) => {\n    const copyableText = event.trigger.parentElement\n\n    const message = (\n      copyableText.getAttribute('data-copyable-text-success-message') ||\n      'Text copied to clipboard.'\n    )\n\n    showStatusMessage(copyableText, message)\n  })\n\n  clipboard.on('error', (event) => {\n    const copyableText = event.trigger.parentElement\n\n    const message = (\n      copyableText.getAttribute('data-copyable-text-error-message') ||\n      'Something went wrong.'\n    )\n\n    showStatusMessage(copyableText, message)\n  })\n}\n\n/**\n * Read-only text input component with a button to copy the text to the\n * user's clipboard\n *\n * Progressively enhances the input by generating the button and status\n * message entirely in the JavaScript.\n *\n * Currently only supports <input>s but it can be easily modified to support\n * <textarea>s in the future.\n *\n * @see copyable-text.less\n */\nfunction setUpCopyableTexts() {\n  const copyableTexts = document.querySelectorAll('[data-copyable-text]:not([data-copyable-text-ready])')\n\n  // No components found, abort\n  if (copyableTexts.length <= 0) return\n\n  // Browser cannot programmatically copy, abort\n  if (!ClipboardJS.isSupported()) return\n\n  // Turn into an array so we can use forEach()\n  [...copyableTexts].forEach(setUpCopyableText)\n  setUpClipboardJS()\n}\n\nexport default setUpCopyableTexts\n","/*!\n * clipboard.js v2.0.4\n * https://zenorocha.github.io/clipboard.js\n * \n * Licensed MIT © Zeno Rocha\n */\n(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ClipboardJS\"] = factory();\n\telse\n\t\troot[\"ClipboardJS\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// define __esModule on exports\n/******/ \t__webpack_require__.r = function(exports) {\n/******/ \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t};\n/******/\n/******/ \t// create a fake namespace object\n/******/ \t// mode & 1: value is a module id, require it\n/******/ \t// mode & 2: merge all properties of value into the ns\n/******/ \t// mode & 4: return value when already ns object\n/******/ \t// mode & 8|1: behave like require\n/******/ \t__webpack_require__.t = function(value, mode) {\n/******/ \t\tif(mode & 1) value = __webpack_require__(value);\n/******/ \t\tif(mode & 8) return value;\n/******/ \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n/******/ \t\tvar ns = Object.create(null);\n/******/ \t\t__webpack_require__.r(ns);\n/******/ \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n/******/ \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n/******/ \t\treturn ns;\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _clipboardAction = __webpack_require__(1);\n\nvar _clipboardAction2 = _interopRequireDefault(_clipboardAction);\n\nvar _tinyEmitter = __webpack_require__(3);\n\nvar _tinyEmitter2 = _interopRequireDefault(_tinyEmitter);\n\nvar _goodListener = __webpack_require__(4);\n\nvar _goodListener2 = _interopRequireDefault(_goodListener);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n/**\n * Base class which takes one or more elements, adds event listeners to them,\n * and instantiates a new `ClipboardAction` on each click.\n */\nvar Clipboard = function (_Emitter) {\n    _inherits(Clipboard, _Emitter);\n\n    /**\n     * @param {String|HTMLElement|HTMLCollection|NodeList} trigger\n     * @param {Object} options\n     */\n    function Clipboard(trigger, options) {\n        _classCallCheck(this, Clipboard);\n\n        var _this = _possibleConstructorReturn(this, (Clipboard.__proto__ || Object.getPrototypeOf(Clipboard)).call(this));\n\n        _this.resolveOptions(options);\n        _this.listenClick(trigger);\n        return _this;\n    }\n\n    /**\n     * Defines if attributes would be resolved using internal setter functions\n     * or custom functions that were passed in the constructor.\n     * @param {Object} options\n     */\n\n\n    _createClass(Clipboard, [{\n        key: 'resolveOptions',\n        value: function resolveOptions() {\n            var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n            this.action = typeof options.action === 'function' ? options.action : this.defaultAction;\n            this.target = typeof options.target === 'function' ? options.target : this.defaultTarget;\n            this.text = typeof options.text === 'function' ? options.text : this.defaultText;\n            this.container = _typeof(options.container) === 'object' ? options.container : document.body;\n        }\n\n        /**\n         * Adds a click event listener to the passed trigger.\n         * @param {String|HTMLElement|HTMLCollection|NodeList} trigger\n         */\n\n    }, {\n        key: 'listenClick',\n        value: function listenClick(trigger) {\n            var _this2 = this;\n\n            this.listener = (0, _goodListener2.default)(trigger, 'click', function (e) {\n                return _this2.onClick(e);\n            });\n        }\n\n        /**\n         * Defines a new `ClipboardAction` on each click event.\n         * @param {Event} e\n         */\n\n    }, {\n        key: 'onClick',\n        value: function onClick(e) {\n            var trigger = e.delegateTarget || e.currentTarget;\n\n            if (this.clipboardAction) {\n                this.clipboardAction = null;\n            }\n\n            this.clipboardAction = new _clipboardAction2.default({\n                action: this.action(trigger),\n                target: this.target(trigger),\n                text: this.text(trigger),\n                container: this.container,\n                trigger: trigger,\n                emitter: this\n            });\n        }\n\n        /**\n         * Default `action` lookup function.\n         * @param {Element} trigger\n         */\n\n    }, {\n        key: 'defaultAction',\n        value: function defaultAction(trigger) {\n            return getAttributeValue('action', trigger);\n        }\n\n        /**\n         * Default `target` lookup function.\n         * @param {Element} trigger\n         */\n\n    }, {\n        key: 'defaultTarget',\n        value: function defaultTarget(trigger) {\n            var selector = getAttributeValue('target', trigger);\n\n            if (selector) {\n                return document.querySelector(selector);\n            }\n        }\n\n        /**\n         * Returns the support of the given action, or all actions if no action is\n         * given.\n         * @param {String} [action]\n         */\n\n    }, {\n        key: 'defaultText',\n\n\n        /**\n         * Default `text` lookup function.\n         * @param {Element} trigger\n         */\n        value: function defaultText(trigger) {\n            return getAttributeValue('text', trigger);\n        }\n\n        /**\n         * Destroy lifecycle.\n         */\n\n    }, {\n        key: 'destroy',\n        value: function destroy() {\n            this.listener.destroy();\n\n            if (this.clipboardAction) {\n                this.clipboardAction.destroy();\n                this.clipboardAction = null;\n            }\n        }\n    }], [{\n        key: 'isSupported',\n        value: function isSupported() {\n            var action = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : ['copy', 'cut'];\n\n            var actions = typeof action === 'string' ? [action] : action;\n            var support = !!document.queryCommandSupported;\n\n            actions.forEach(function (action) {\n                support = support && !!document.queryCommandSupported(action);\n            });\n\n            return support;\n        }\n    }]);\n\n    return Clipboard;\n}(_tinyEmitter2.default);\n\n/**\n * Helper function to retrieve attribute value.\n * @param {String} suffix\n * @param {Element} element\n */\n\n\nfunction getAttributeValue(suffix, element) {\n    var attribute = 'data-clipboard-' + suffix;\n\n    if (!element.hasAttribute(attribute)) {\n        return;\n    }\n\n    return element.getAttribute(attribute);\n}\n\nmodule.exports = Clipboard;\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _select = __webpack_require__(2);\n\nvar _select2 = _interopRequireDefault(_select);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Inner class which performs selection from either `text` or `target`\n * properties and then executes copy or cut operations.\n */\nvar ClipboardAction = function () {\n    /**\n     * @param {Object} options\n     */\n    function ClipboardAction(options) {\n        _classCallCheck(this, ClipboardAction);\n\n        this.resolveOptions(options);\n        this.initSelection();\n    }\n\n    /**\n     * Defines base properties passed from constructor.\n     * @param {Object} options\n     */\n\n\n    _createClass(ClipboardAction, [{\n        key: 'resolveOptions',\n        value: function resolveOptions() {\n            var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n            this.action = options.action;\n            this.container = options.container;\n            this.emitter = options.emitter;\n            this.target = options.target;\n            this.text = options.text;\n            this.trigger = options.trigger;\n\n            this.selectedText = '';\n        }\n\n        /**\n         * Decides which selection strategy is going to be applied based\n         * on the existence of `text` and `target` properties.\n         */\n\n    }, {\n        key: 'initSelection',\n        value: function initSelection() {\n            if (this.text) {\n                this.selectFake();\n            } else if (this.target) {\n                this.selectTarget();\n            }\n        }\n\n        /**\n         * Creates a fake textarea element, sets its value from `text` property,\n         * and makes a selection on it.\n         */\n\n    }, {\n        key: 'selectFake',\n        value: function selectFake() {\n            var _this = this;\n\n            var isRTL = document.documentElement.getAttribute('dir') == 'rtl';\n\n            this.removeFake();\n\n            this.fakeHandlerCallback = function () {\n                return _this.removeFake();\n            };\n            this.fakeHandler = this.container.addEventListener('click', this.fakeHandlerCallback) || true;\n\n            this.fakeElem = document.createElement('textarea');\n            // Prevent zooming on iOS\n            this.fakeElem.style.fontSize = '12pt';\n            // Reset box model\n            this.fakeElem.style.border = '0';\n            this.fakeElem.style.padding = '0';\n            this.fakeElem.style.margin = '0';\n            // Move element out of screen horizontally\n            this.fakeElem.style.position = 'absolute';\n            this.fakeElem.style[isRTL ? 'right' : 'left'] = '-9999px';\n            // Move element to the same position vertically\n            var yPosition = window.pageYOffset || document.documentElement.scrollTop;\n            this.fakeElem.style.top = yPosition + 'px';\n\n            this.fakeElem.setAttribute('readonly', '');\n            this.fakeElem.value = this.text;\n\n            this.container.appendChild(this.fakeElem);\n\n            this.selectedText = (0, _select2.default)(this.fakeElem);\n            this.copyText();\n        }\n\n        /**\n         * Only removes the fake element after another click event, that way\n         * a user can hit `Ctrl+C` to copy because selection still exists.\n         */\n\n    }, {\n        key: 'removeFake',\n        value: function removeFake() {\n            if (this.fakeHandler) {\n                this.container.removeEventListener('click', this.fakeHandlerCallback);\n                this.fakeHandler = null;\n                this.fakeHandlerCallback = null;\n            }\n\n            if (this.fakeElem) {\n                this.container.removeChild(this.fakeElem);\n                this.fakeElem = null;\n            }\n        }\n\n        /**\n         * Selects the content from element passed on `target` property.\n         */\n\n    }, {\n        key: 'selectTarget',\n        value: function selectTarget() {\n            this.selectedText = (0, _select2.default)(this.target);\n            this.copyText();\n        }\n\n        /**\n         * Executes the copy operation based on the current selection.\n         */\n\n    }, {\n        key: 'copyText',\n        value: function copyText() {\n            var succeeded = void 0;\n\n            try {\n                succeeded = document.execCommand(this.action);\n            } catch (err) {\n                succeeded = false;\n            }\n\n            this.handleResult(succeeded);\n        }\n\n        /**\n         * Fires an event based on the copy operation result.\n         * @param {Boolean} succeeded\n         */\n\n    }, {\n        key: 'handleResult',\n        value: function handleResult(succeeded) {\n            this.emitter.emit(succeeded ? 'success' : 'error', {\n                action: this.action,\n                text: this.selectedText,\n                trigger: this.trigger,\n                clearSelection: this.clearSelection.bind(this)\n            });\n        }\n\n        /**\n         * Moves focus away from `target` and back to the trigger, removes current selection.\n         */\n\n    }, {\n        key: 'clearSelection',\n        value: function clearSelection() {\n            if (this.trigger) {\n                this.trigger.focus();\n            }\n\n            window.getSelection().removeAllRanges();\n        }\n\n        /**\n         * Sets the `action` to be performed which can be either 'copy' or 'cut'.\n         * @param {String} action\n         */\n\n    }, {\n        key: 'destroy',\n\n\n        /**\n         * Destroy lifecycle.\n         */\n        value: function destroy() {\n            this.removeFake();\n        }\n    }, {\n        key: 'action',\n        set: function set() {\n            var action = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'copy';\n\n            this._action = action;\n\n            if (this._action !== 'copy' && this._action !== 'cut') {\n                throw new Error('Invalid \"action\" value, use either \"copy\" or \"cut\"');\n            }\n        }\n\n        /**\n         * Gets the `action` property.\n         * @return {String}\n         */\n        ,\n        get: function get() {\n            return this._action;\n        }\n\n        /**\n         * Sets the `target` property using an element\n         * that will be have its content copied.\n         * @param {Element} target\n         */\n\n    }, {\n        key: 'target',\n        set: function set(target) {\n            if (target !== undefined) {\n                if (target && (typeof target === 'undefined' ? 'undefined' : _typeof(target)) === 'object' && target.nodeType === 1) {\n                    if (this.action === 'copy' && target.hasAttribute('disabled')) {\n                        throw new Error('Invalid \"target\" attribute. Please use \"readonly\" instead of \"disabled\" attribute');\n                    }\n\n                    if (this.action === 'cut' && (target.hasAttribute('readonly') || target.hasAttribute('disabled'))) {\n                        throw new Error('Invalid \"target\" attribute. You can\\'t cut text from elements with \"readonly\" or \"disabled\" attributes');\n                    }\n\n                    this._target = target;\n                } else {\n                    throw new Error('Invalid \"target\" value, use a valid Element');\n                }\n            }\n        }\n\n        /**\n         * Gets the `target` property.\n         * @return {String|HTMLElement}\n         */\n        ,\n        get: function get() {\n            return this._target;\n        }\n    }]);\n\n    return ClipboardAction;\n}();\n\nmodule.exports = ClipboardAction;\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports) {\n\nfunction select(element) {\n    var selectedText;\n\n    if (element.nodeName === 'SELECT') {\n        element.focus();\n\n        selectedText = element.value;\n    }\n    else if (element.nodeName === 'INPUT' || element.nodeName === 'TEXTAREA') {\n        var isReadOnly = element.hasAttribute('readonly');\n\n        if (!isReadOnly) {\n            element.setAttribute('readonly', '');\n        }\n\n        element.select();\n        element.setSelectionRange(0, element.value.length);\n\n        if (!isReadOnly) {\n            element.removeAttribute('readonly');\n        }\n\n        selectedText = element.value;\n    }\n    else {\n        if (element.hasAttribute('contenteditable')) {\n            element.focus();\n        }\n\n        var selection = window.getSelection();\n        var range = document.createRange();\n\n        range.selectNodeContents(element);\n        selection.removeAllRanges();\n        selection.addRange(range);\n\n        selectedText = selection.toString();\n    }\n\n    return selectedText;\n}\n\nmodule.exports = select;\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports) {\n\nfunction E () {\n  // Keep this empty so it's easier to inherit from\n  // (via https://github.com/lipsmack from https://github.com/scottcorgan/tiny-emitter/issues/3)\n}\n\nE.prototype = {\n  on: function (name, callback, ctx) {\n    var e = this.e || (this.e = {});\n\n    (e[name] || (e[name] = [])).push({\n      fn: callback,\n      ctx: ctx\n    });\n\n    return this;\n  },\n\n  once: function (name, callback, ctx) {\n    var self = this;\n    function listener () {\n      self.off(name, listener);\n      callback.apply(ctx, arguments);\n    };\n\n    listener._ = callback\n    return this.on(name, listener, ctx);\n  },\n\n  emit: function (name) {\n    var data = [].slice.call(arguments, 1);\n    var evtArr = ((this.e || (this.e = {}))[name] || []).slice();\n    var i = 0;\n    var len = evtArr.length;\n\n    for (i; i < len; i++) {\n      evtArr[i].fn.apply(evtArr[i].ctx, data);\n    }\n\n    return this;\n  },\n\n  off: function (name, callback) {\n    var e = this.e || (this.e = {});\n    var evts = e[name];\n    var liveEvents = [];\n\n    if (evts && callback) {\n      for (var i = 0, len = evts.length; i < len; i++) {\n        if (evts[i].fn !== callback && evts[i].fn._ !== callback)\n          liveEvents.push(evts[i]);\n      }\n    }\n\n    // Remove event from queue to prevent memory leak\n    // Suggested by https://github.com/lazd\n    // Ref: https://github.com/scottcorgan/tiny-emitter/commit/c6ebfaa9bc973b33d110a84a307742b7cf94c953#commitcomment-5024910\n\n    (liveEvents.length)\n      ? e[name] = liveEvents\n      : delete e[name];\n\n    return this;\n  }\n};\n\nmodule.exports = E;\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar is = __webpack_require__(5);\nvar delegate = __webpack_require__(6);\n\n/**\n * Validates all params and calls the right\n * listener function based on its target type.\n *\n * @param {String|HTMLElement|HTMLCollection|NodeList} target\n * @param {String} type\n * @param {Function} callback\n * @return {Object}\n */\nfunction listen(target, type, callback) {\n    if (!target && !type && !callback) {\n        throw new Error('Missing required arguments');\n    }\n\n    if (!is.string(type)) {\n        throw new TypeError('Second argument must be a String');\n    }\n\n    if (!is.fn(callback)) {\n        throw new TypeError('Third argument must be a Function');\n    }\n\n    if (is.node(target)) {\n        return listenNode(target, type, callback);\n    }\n    else if (is.nodeList(target)) {\n        return listenNodeList(target, type, callback);\n    }\n    else if (is.string(target)) {\n        return listenSelector(target, type, callback);\n    }\n    else {\n        throw new TypeError('First argument must be a String, HTMLElement, HTMLCollection, or NodeList');\n    }\n}\n\n/**\n * Adds an event listener to a HTML element\n * and returns a remove listener function.\n *\n * @param {HTMLElement} node\n * @param {String} type\n * @param {Function} callback\n * @return {Object}\n */\nfunction listenNode(node, type, callback) {\n    node.addEventListener(type, callback);\n\n    return {\n        destroy: function() {\n            node.removeEventListener(type, callback);\n        }\n    }\n}\n\n/**\n * Add an event listener to a list of HTML elements\n * and returns a remove listener function.\n *\n * @param {NodeList|HTMLCollection} nodeList\n * @param {String} type\n * @param {Function} callback\n * @return {Object}\n */\nfunction listenNodeList(nodeList, type, callback) {\n    Array.prototype.forEach.call(nodeList, function(node) {\n        node.addEventListener(type, callback);\n    });\n\n    return {\n        destroy: function() {\n            Array.prototype.forEach.call(nodeList, function(node) {\n                node.removeEventListener(type, callback);\n            });\n        }\n    }\n}\n\n/**\n * Add an event listener to a selector\n * and returns a remove listener function.\n *\n * @param {String} selector\n * @param {String} type\n * @param {Function} callback\n * @return {Object}\n */\nfunction listenSelector(selector, type, callback) {\n    return delegate(document.body, selector, type, callback);\n}\n\nmodule.exports = listen;\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports) {\n\n/**\n * Check if argument is a HTML element.\n *\n * @param {Object} value\n * @return {Boolean}\n */\nexports.node = function(value) {\n    return value !== undefined\n        && value instanceof HTMLElement\n        && value.nodeType === 1;\n};\n\n/**\n * Check if argument is a list of HTML elements.\n *\n * @param {Object} value\n * @return {Boolean}\n */\nexports.nodeList = function(value) {\n    var type = Object.prototype.toString.call(value);\n\n    return value !== undefined\n        && (type === '[object NodeList]' || type === '[object HTMLCollection]')\n        && ('length' in value)\n        && (value.length === 0 || exports.node(value[0]));\n};\n\n/**\n * Check if argument is a string.\n *\n * @param {Object} value\n * @return {Boolean}\n */\nexports.string = function(value) {\n    return typeof value === 'string'\n        || value instanceof String;\n};\n\n/**\n * Check if argument is a function.\n *\n * @param {Object} value\n * @return {Boolean}\n */\nexports.fn = function(value) {\n    var type = Object.prototype.toString.call(value);\n\n    return type === '[object Function]';\n};\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar closest = __webpack_require__(7);\n\n/**\n * Delegates event to a selector.\n *\n * @param {Element} element\n * @param {String} selector\n * @param {String} type\n * @param {Function} callback\n * @param {Boolean} useCapture\n * @return {Object}\n */\nfunction _delegate(element, selector, type, callback, useCapture) {\n    var listenerFn = listener.apply(this, arguments);\n\n    element.addEventListener(type, listenerFn, useCapture);\n\n    return {\n        destroy: function() {\n            element.removeEventListener(type, listenerFn, useCapture);\n        }\n    }\n}\n\n/**\n * Delegates event to a selector.\n *\n * @param {Element|String|Array} [elements]\n * @param {String} selector\n * @param {String} type\n * @param {Function} callback\n * @param {Boolean} useCapture\n * @return {Object}\n */\nfunction delegate(elements, selector, type, callback, useCapture) {\n    // Handle the regular Element usage\n    if (typeof elements.addEventListener === 'function') {\n        return _delegate.apply(null, arguments);\n    }\n\n    // Handle Element-less usage, it defaults to global delegation\n    if (typeof type === 'function') {\n        // Use `document` as the first parameter, then apply arguments\n        // This is a short way to .unshift `arguments` without running into deoptimizations\n        return _delegate.bind(null, document).apply(null, arguments);\n    }\n\n    // Handle Selector-based usage\n    if (typeof elements === 'string') {\n        elements = document.querySelectorAll(elements);\n    }\n\n    // Handle Array-like based usage\n    return Array.prototype.map.call(elements, function (element) {\n        return _delegate(element, selector, type, callback, useCapture);\n    });\n}\n\n/**\n * Finds closest match and invokes callback.\n *\n * @param {Element} element\n * @param {String} selector\n * @param {String} type\n * @param {Function} callback\n * @return {Function}\n */\nfunction listener(element, selector, type, callback) {\n    return function(e) {\n        e.delegateTarget = closest(e.target, selector);\n\n        if (e.delegateTarget) {\n            callback.call(element, e);\n        }\n    }\n}\n\nmodule.exports = delegate;\n\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports) {\n\nvar DOCUMENT_NODE_TYPE = 9;\n\n/**\n * A polyfill for Element.matches()\n */\nif (typeof Element !== 'undefined' && !Element.prototype.matches) {\n    var proto = Element.prototype;\n\n    proto.matches = proto.matchesSelector ||\n                    proto.mozMatchesSelector ||\n                    proto.msMatchesSelector ||\n                    proto.oMatchesSelector ||\n                    proto.webkitMatchesSelector;\n}\n\n/**\n * Finds the closest parent that matches a selector.\n *\n * @param {Element} element\n * @param {String} selector\n * @return {Function}\n */\nfunction closest (element, selector) {\n    while (element && element.nodeType !== DOCUMENT_NODE_TYPE) {\n        if (typeof element.matches === 'function' &&\n            element.matches(selector)) {\n          return element;\n        }\n        element = element.parentNode;\n    }\n}\n\nmodule.exports = closest;\n\n\n/***/ })\n/******/ ]);\n});","module.exports = __webpack_public_path__ + \"archive.min.css\";"],"sourceRoot":""}